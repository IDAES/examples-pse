<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HDA Flowsheet Simulation and Optimization &mdash; IDAES v1.13.0 Examples</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> IDAES Examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/index.html">IDAES Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IDAES Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>HDA Flowsheet Simulation and Optimization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Examples/Flowsheets/HDA_flowsheet_with_distillation_solution.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hda-flowsheet-simulation-and-optimization">
<h1>HDA Flowsheet Simulation and Optimization<a class="headerlink" href="#hda-flowsheet-simulation-and-optimization" title="Permalink to this headline">¶</a></h1>
<section id="note">
<h2>Note<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will be similar to the HDA flowsheet tutorial in the
Tutorials section, except that we use a distillation column instead of a
second flash (F102) to produce benzene and toluene products.</p>
</section>
<section id="learning-outcomes">
<h2>Learning outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Construct a steady-state flowsheet using the IDAES unit model library</p></li>
<li><p>Connecting unit models in a flowsheet using Arcs</p></li>
<li><p>Using the SequentialDecomposition tool to initialize a flowsheet with
recycle</p></li>
<li><p>Fomulate and solve an optimization problem</p>
<ul>
<li><p>Defining an objective function</p></li>
<li><p>Setting variable bounds</p></li>
<li><p>Adding additional constraints</p></li>
</ul>
</li>
</ul>
</section>
<section id="problem-statement">
<h2>Problem Statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>Hydrodealkylation is a chemical reaction that often involves reacting an
aromatic hydrocarbon in the presence of hydrogen gas to form a simpler
aromatic hydrocarbon devoid of functional groups. In this example,
toluene will be reacted with hydrogen gas at high temperatures to form
benzene via the following reaction:</p>
<p><strong>C6H5CH3 + H2 → C6H6 + CH4</strong></p>
<p>This reaction is often accompanied by an equilibrium side reaction which
forms diphenyl, which we will neglect for this example.</p>
<p>This example is based on the 1967 AIChE Student Contest problem as
present by Douglas, J.M., Chemical Design of Chemical Processes, 1988,
McGraw-Hill.</p>
<p>The flowsheet that we will be using for this module is shown below with
the stream conditions. We will be processing toluene and hydrogen to
produce at least 370 TPY of benzene. As shown in the flowsheet, we use a
flash tank, F101, to separate out the non-condensibles, and a
distillation column, D101, to further separate the benzene-toluene
mixture to improve the benzene purity. The non-condensibles separated
out in F101 will be partially recycled back to M101 and the rest will be
purged. We will assume ideal gas behavior for this flowsheet. The
properties required for this module are defined in</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hda_ideal_VLE.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idaes.generic_models.properties.activity_coeff_models.BTX_activity_coeff_VLE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hda_reaction_kinetic.py</span></code></p></li>
</ul>
<p>We will be using two thermodynamic packages: one (first in the list
above) containing all four components (i.e., toluene, hydrogen, benzene,
and methane) and the other (second in the list above) containing benzene
and toluene only. The latter is needed to simplify the VLE calculations
in the distillation column model.</p>
<img alt="../../_images/HDA_flowsheet_distillation.png" src="../../_images/HDA_flowsheet_distillation.png" />
</section>
<section id="translator-block">
<h2>Translator block<a class="headerlink" href="#translator-block" title="Permalink to this headline">¶</a></h2>
<p>Benzene and toluene are separated by distillation, so the process
involves phase equilibrium and two-phase flow conditions. However, the
presence of hydrogen and methane complicates the calculations. This is
because, hydrogen and methane are non-condensable under all conditions
of interest; ergo, a vapor phase will always be present, and the mixture
bubble point is extremely low. To simplify the phase equilibrium
calculations, hydrogen and methane will be considered completely as
non-condensable and insoluble in the liquid outlet from the flash F101.</p>
<p>Since no hydrogen and methane will be present in the unit operations
following the flash, a different component list can be used to simplify
the property calculations. IDAES supports the definition of multiple
property packages within a single flowsheet via <code class="docutils literal notranslate"><span class="pre">Translator</span></code> blocks.
<code class="docutils literal notranslate"><span class="pre">Translator</span></code> blocks convert between different property calculations,
component lists, and equations of state.</p>
</section>
<section id="importing-required-pyomo-and-idaes-components">
<h2>Importing required pyomo and idaes components<a class="headerlink" href="#importing-required-pyomo-and-idaes-components" title="Permalink to this headline">¶</a></h2>
<p>To construct a flowsheet, we will need several components from the pyomo
and idaes package. Let us first import the following components from
Pyomo: - Constraint (to write constraints) - Var (to declare variables)
- ConcreteModel (to create the concrete model object) - Expression (to
evaluate values as a function of variables defined in the model) -
Objective (to define an objective function for optimization) -
SolverFactory (to solve the problem) - TransformationFactory (to apply
certain transformations) - Arc (to connect two unit models) -
SequentialDecomposition (to initialize the flowsheet in a sequential
mode)</p>
<p>For further details on these components, please refer to the pyomo
documentation: <a class="reference external" href="https://pyomo.readthedocs.io/en/latest/">https://pyomo.readthedocs.io/en/latest/</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Constraint</span><span class="p">,</span>
                           <span class="n">Var</span><span class="p">,</span>
                           <span class="n">ConcreteModel</span><span class="p">,</span>
                           <span class="n">Expression</span><span class="p">,</span>
                           <span class="n">Objective</span><span class="p">,</span>
                           <span class="n">TransformationFactory</span><span class="p">,</span>
                           <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Import <code class="docutils literal notranslate"><span class="pre">Arc</span></code> and <code class="docutils literal notranslate"><span class="pre">SequentialDecomposition</span></code> tools
from <code class="docutils literal notranslate"><span class="pre">pyomo.network</span></code></p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Import the above mentioned tools from pyomo.network</span>
<span class="kn">from</span> <span class="nn">pyomo.network</span> <span class="kn">import</span> <span class="n">Arc</span><span class="p">,</span> <span class="n">SequentialDecomposition</span>
</pre></div>
</div>
<p>From idaes, we will be needing the FlowsheetBlock and the following unit
models: - Mixer - Heater - CSTR - Flash - Separator (splitter) -
PressureChanger - Translator (to switch from one property package to
another) - TrayColumn (distillation column) - CondenserType (Type of the
overhead condenser: complete or partial) - TemperatureSpec (Temperature
specification inside the condenser)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">idaes.generic_models.unit_models</span> <span class="kn">import</span> <span class="p">(</span><span class="n">PressureChanger</span><span class="p">,</span>
                                              <span class="n">Mixer</span><span class="p">,</span>
                                              <span class="n">Separator</span> <span class="k">as</span> <span class="n">Splitter</span><span class="p">,</span>
                                              <span class="n">Heater</span><span class="p">,</span>
                                              <span class="n">CSTR</span><span class="p">,</span>
                                              <span class="n">Flash</span><span class="p">,</span>
                                              <span class="n">Translator</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">idaes.generic_models.unit_models.column_models</span> <span class="kn">import</span> <span class="n">TrayColumn</span>
<span class="kn">from</span> <span class="nn">idaes.generic_models.unit_models.column_models.condenser</span> \
    <span class="kn">import</span> <span class="nn">CondenserType</span><span class="o">,</span> <span class="nn">TemperatureSpec</span>
</pre></div>
</div>
<p>We will also be needing some utility tools to put together the flowsheet
and calculate the degrees of freedom.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Utility tools to put together the flowsheet and calculate the degrees of freedom</span>
<span class="kn">from</span> <span class="nn">idaes.generic_models.unit_models.pressure_changer</span> <span class="kn">import</span> <span class="n">ThermodynamicAssumption</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.model_statistics</span> <span class="kn">import</span> <span class="n">degrees_of_freedom</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.initialization</span> <span class="kn">import</span> <span class="n">propagate_state</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.misc</span> <span class="kn">import</span> <span class="n">get_solver</span>
<span class="kn">import</span> <span class="nn">idaes.core.util.scaling</span> <span class="k">as</span> <span class="nn">iscale</span>

<span class="c1"># Import idaes logger to set output levels</span>
<span class="kn">import</span> <span class="nn">idaes.logger</span> <span class="k">as</span> <span class="nn">idaeslog</span>
</pre></div>
</div>
</section>
<section id="importing-required-thermo-and-reaction-packages">
<h2>Importing required thermo and reaction packages<a class="headerlink" href="#importing-required-thermo-and-reaction-packages" title="Permalink to this headline">¶</a></h2>
<p>Finally, we import the thermophysical (<code class="docutils literal notranslate"><span class="pre">hda_ideal_VLE.py</span></code> and
<code class="docutils literal notranslate"><span class="pre">BTXParameterBlock</span></code>) packages and reaction package
(<code class="docutils literal notranslate"><span class="pre">hda_reaction_kinetic.py</span></code>) for the HDA process. We have created
custom thermophysical packages that assume ideal gas behavior with
support for VLE. The reaction package consists of the stochiometric
coefficients for the reaction, heat of reaction, and kinetic information
(Arrhenius constant and activation energy).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hda_reaction_kinetic</span> <span class="k">as</span> <span class="nn">reaction_props</span>
<span class="kn">from</span> <span class="nn">idaes.generic_models.properties.activity_coeff_models.</span>\
    <span class="n">BTX_activity_coeff_VLE</span> <span class="kn">import</span> <span class="nn">BTXParameterBlock</span>

<span class="kn">from</span> <span class="nn">hda_ideal_VLE</span> <span class="kn">import</span> <span class="n">HDAParameterBlock</span>
</pre></div>
</div>
</section>
<section id="constructing-the-flowsheet">
<h2>Constructing the Flowsheet<a class="headerlink" href="#constructing-the-flowsheet" title="Permalink to this headline">¶</a></h2>
<p>We have now imported all the components, unit models, and property
modules we need to construct a flowsheet. Let us create a ConcreteModel
and add the flowsheet block to it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a Pyomo Concrete Model to contain the problem</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

<span class="c1"># Add a steady state flowsheet block to the model</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dynamic&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<p>We will now add the thermophysical and reaction packages to the
flowsheet.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Property package for benzene, toluene, hydrogen, methane mixture</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span> <span class="o">=</span> <span class="n">HDAParameterBlock</span><span class="p">()</span>

<span class="c1"># Property package for the benzene-toluene mixture</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BT_params</span> <span class="o">=</span> <span class="n">BTXParameterBlock</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;valid_phase&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;Vap&#39;</span><span class="p">),</span>
        <span class="s2">&quot;activity_coeff_model&quot;</span><span class="p">:</span> <span class="s2">&quot;Ideal&quot;</span>
<span class="p">})</span>

<span class="c1"># Reaction package for the HDA reaction</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">reaction_params</span> <span class="o">=</span> <span class="n">reaction_props</span><span class="o">.</span><span class="n">HDAReactionParameterBlock</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="adding-unit-models">
<h2>Adding Unit Models<a class="headerlink" href="#adding-unit-models" title="Permalink to this headline">¶</a></h2>
<p>Let us start adding the unit models we have imported to the flowsheet.
Here, we are adding the Mixer (assigned a name M101) and a Heater
(assigned a name H101). Note that, all unit models need to be given a
property package argument. In addition, the Mixer unit model needs a
<code class="docutils literal notranslate"><span class="pre">list</span></code> consisting of the inlets (toluene feed, hydrogen feed and vapor
recycle streams in this case).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding the mixer M101 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span> <span class="o">=</span> <span class="n">Mixer</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
                           <span class="s2">&quot;inlet_list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;toluene_feed&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen_feed&quot;</span><span class="p">,</span> <span class="s2">&quot;vapor_recycle&quot;</span><span class="p">]})</span>

<span class="c1"># Adding the heater H101 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span> <span class="o">=</span> <span class="n">Heater</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
                            <span class="s2">&quot;has_phase_equilibrium&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Let us now add the CSTR (assign the name R101) and
pass the following arguments:</p>
<ul><li><p>“property_package”: m.fs.BTHM_params</p>
</li><li><p>“reaction_package”: m.fs.reaction_params</p>
</li><li><p>“has_heat_of_reaction”: True</p>
</li><li><p>“has_heat_transfer”: True</p>
</li></ul></div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Add reactor with the specifications above</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span> <span class="o">=</span> <span class="n">CSTR</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
                     <span class="s2">&quot;reaction_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">reaction_params</span><span class="p">,</span>
                     <span class="s2">&quot;has_heat_of_reaction&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                     <span class="s2">&quot;has_heat_transfer&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Let us now add the Flash (assign the name F101), Splitter (assign the
name S101) and PressureChanger (assign the name C101)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding the flash tank F101 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span> <span class="o">=</span> <span class="n">Flash</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
                           <span class="s2">&quot;has_heat_transfer&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="s2">&quot;has_pressure_change&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Adding the splitter S101 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">S101</span> <span class="o">=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
                              <span class="s2">&quot;outlet_list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;purge&quot;</span><span class="p">,</span> <span class="s2">&quot;recycle&quot;</span><span class="p">]})</span>

<span class="c1"># Adding the compressor C101 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">C101</span> <span class="o">=</span> <span class="n">PressureChanger</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
            <span class="s2">&quot;compressor&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;thermodynamic_assumption&quot;</span><span class="p">:</span> <span class="n">ThermodynamicAssumption</span><span class="o">.</span><span class="n">isothermal</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="remark">
<h2>Remark<a class="headerlink" href="#remark" title="Permalink to this headline">¶</a></h2>
<p>Currently, the <code class="docutils literal notranslate"><span class="pre">SequentialDecomposition()</span></code> tool, which we will later
be using to initialize the flowsheet, does not support the distillation
column model. Thus, we will first simulate the flowsheet without the
distillation column. After it converges, we will then add the
distillation column, initialize it, and simulate the entire flowsheet.</p>
<p>As mentioned above, we use the <code class="docutils literal notranslate"><span class="pre">m.fs.BTHM_params</span></code> package, which
contains all the four species, for the reactor loop, and the simpler
<code class="docutils literal notranslate"><span class="pre">m.fs.BT_params</span></code> for unit operations following the flash (i.e., heater
H102 and the distillation column D101). We define a <code class="docutils literal notranslate"><span class="pre">Translator</span></code> block
to link the source property package and the package it is to be
translated to in the following manner:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add translator block to convert between property packages</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">Translator</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;inlet_property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BTHM_params</span><span class="p">,</span>
        <span class="s2">&quot;outlet_property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BT_params</span>
<span class="p">})</span>
</pre></div>
</div>
<section id="translator-block-constraints">
<h3>Translator block constraints<a class="headerlink" href="#translator-block-constraints" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Translator</span></code> block needs to know how to translate between the two
property packages. This must be custom coded for each application
because of the generality of the IDAES framework.</p>
<p>For this process, five constraints are required based on the state
variables used in the outgoing process.</p>
<ul class="simple">
<li><p>Since we assumed that only benzene and toluene are present in the
liquid phase, the total molar flowrate must be the sum of molar
flowrates of benzene and toluene, respectively.</p></li>
<li><p>Temperature of the inlet and outlet streams must be the same.</p></li>
<li><p>Pressure of the inlet and outgoing streams must be the same</p></li>
<li><p>The mole fraction of benzene in the outgoing stream is the ratio of
the molar flowrate of liquid benzene in the inlet to the sum of molar
flowrates of liquid benzene and toluene in the inlet.</p></li>
<li><p>The mole fraction of toluene in the outgoing stream is the ratio of
the molar flowrate of liquid toluene in the inlet to the sum of molar
flowrates of liquid benzene and toluene in the inlet.</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add constraint: Total flow = benzene flow + toluene flow (molar)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">eq_total_flow</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">])</span>

<span class="c1"># Add constraint: Outlet temperature = Inlet temperature</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">eq_temperature</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>In the above, note that the variable flow_mol_phase_comp has the index -
[time, phase, component]. As this is a steady-state flowsheet, the time
index by default is 0. The valid phases are [“Liq”, “Vap”]. Similarly
the valid component list is [“benzene”, “toluene”, “hydrogen”,
“methane”].</p>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Add the constraint to ensure that the outlet
pressure is the same as the inlet pressure</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Add constraint: Outlet pressure = Inlet pressure</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">eq_pressure</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remaining constraints on the translator block</span>

<span class="c1"># Add constraint: Benzene mole fraction definition</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">eq_mole_frac_benzene</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">==</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">/</span>
    <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]))</span>

<span class="c1"># Add constraint: Toluene mole fraction definition</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">eq_mole_frac_toluene</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span> <span class="o">==</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span> <span class="o">/</span>
    <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Finally, let us add the Heater H102 in the same way
as H101 but pass the m.fs.BT_params thermodynamic package. We will
add the distillation column after converging the flowsheet.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Add the Heater H102 to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span> <span class="o">=</span> <span class="n">Heater</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BT_params</span><span class="p">,</span>
                            <span class="s2">&quot;has_pressure_change&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="s2">&quot;has_phase_equilibrium&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<section id="connecting-unit-models-using-arcs">
<h2>Connecting Unit Models using Arcs<a class="headerlink" href="#connecting-unit-models-using-arcs" title="Permalink to this headline">¶</a></h2>
<p>We have now added the initial set of unit models to the flowsheet.
However, we have not yet specifed how the units are connected. To do
this, we will be using the <code class="docutils literal notranslate"><span class="pre">Arc</span></code> which is a pyomo component that takes
in two arguments: <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">destination</span></code>. Let us connect the
outlet of the mixer (M101) to the inlet of the heater (H101).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s03</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/HDA_flowsheet_distillation.png" src="../../_images/HDA_flowsheet_distillation.png" />
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Now, connect the H101 outlet to the R101 inlet using
the cell above as a guide.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Connect the H101 outlet to R101 inlet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s04</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
</pre></div>
</div>
<p>We will now be connecting the rest of the units as shown below. Notice
how the outlet names are different for the flash tank as it has a vapor
and a liquid outlet.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s05</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s06</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">S101</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s08</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">S101</span><span class="o">.</span><span class="n">recycle</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">C101</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s09</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">C101</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span>
                   <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">vapor_recycle</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s10a</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">liq_outlet</span><span class="p">,</span>
                   <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s10b</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span>
                   <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">inlet</span><span class="p">)</span>
</pre></div>
</div>
<p>We have now connected the unit model block using the arcs. However, each
of these arcs link to ports on the two unit models that are connected.
In this case, the ports consist of the state variables that need to be
linked between the unit models. Pyomo provides a convenient method to
write these equality constraints for us between two ports and this is
done as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TransformationFactory</span><span class="p">(</span><span class="s2">&quot;network.expand_arcs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<section id="appending-additional-constraints-to-the-model">
<h3>Appending additional constraints to the model<a class="headerlink" href="#appending-additional-constraints-to-the-model" title="Permalink to this headline">¶</a></h3>
<p>Now, we will see how we can add additional constraints to the model
using <code class="docutils literal notranslate"><span class="pre">Constraint</span></code> from Pyomo.</p>
<p>Consider the reactor R101. By default, the conversion of a component is
not calculated when we simulate the flowsheet. If we are interested
either in specifying or constraining the conversion value, we can add
the following constraint to calculate the conversion:</p>
<div class="math notranslate nohighlight">
\[\text{Conversion of toluene} = \frac{\text{molar flow of toluene in the inlet} - \text{molar flow of toluene in the outlet}}{\text{molar flow of toluene in the inlet}}\]</div>
<p>We add the constraint to the model as shown below.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the conversion variables using &#39;Var&#39;</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Append the constraint to the model</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conv_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span>
    <span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span> <span class="o">==</span>
    <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span> <span class="o">-</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</section>
</section>
<section id="fixing-feed-conditions-and-initializing-the-flowsheet">
<h2>Fixing feed conditions and Initializing the flowsheet<a class="headerlink" href="#fixing-feed-conditions-and-initializing-the-flowsheet" title="Permalink to this headline">¶</a></h2>
<p>Let us first check how many degrees of freedom exist for this flowsheet
using the <code class="docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code> tool we imported earlier.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">29</span>
</pre></div>
</div>
<p>We will now be fixing the toluene feed stream to the conditions shown in
the flowsheet above. Please note that though this is a pure toluene
feed, the remaining components are still assigned a very small non-zero
value to help with convergence and initializing.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.30</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">303.2</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">toluene_feed</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">350000</span><span class="p">)</span>
</pre></div>
</div>
<p>Similarly, let us fix the hydrogen feed to the following conditions in
the next cell:</p>
<ul><li><p>FH2 = 0.30 mol/s</p>
</li><li><p>FCH4 = 0.02 mol/s</p>
</li><li><p>Remaining components = 1e-5 mol/s</p>
</li><li><p>T = 303.2 K</p>
</li><li><p>P = 350000 Pa</p>
</li></ul><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.30</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">303.2</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">M101</span><span class="o">.</span><span class="n">hydrogen_feed</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">350000</span><span class="p">)</span>
</pre></div>
</div>
<section id="fixing-unit-model-specifications">
<h3>Fixing unit model specifications<a class="headerlink" href="#fixing-unit-model-specifications" title="Permalink to this headline">¶</a></h3>
<p>Now that we have fixed our inlet feed conditions, we will now be fixing
the operating conditions for the unit models in the flowsheet. Let us
set the H101 outlet temperature to 600 K.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the temperature of the outlet from the heater H101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Set the conditions for the reactor R101 to the
following conditions:</p>
<ul><li><p><code class="docutils literal notranslate"><span class="pre">conversion</span></code> = 0.75</p>
</li><li><p><code class="docutils literal notranslate"><span class="pre">heat_duty</span></code> = 0</p>
</li></ul><p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Fix the &#39;conversion&#39; of the reactor R101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

<span class="c1"># Todo: Fix the &#39;heat_duty&#39; of the reactor R101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The Flash conditions for F101 can be set as follows.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the temperature of the vapor outlet from F101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">325.0</span><span class="p">)</span>

<span class="c1"># Fix the pressure drop in the flash F101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us fix the split fraction of the purge stream from the splitter S101
and the outlet pressure from the compressor C101</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the split fraction of the &#39;purge&#39; stream from S101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">S101</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;purge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Fix the pressure of the outlet from the compressor C101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">C101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">350000</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, let us fix the temperature of the outlet from H102 and the
pressure drop in H102 as the following</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the temperature of the outlet from the heater H102</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">375</span><span class="p">)</span>

<span class="c1"># Fix the pressure drop in the heater H102</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="o">-</span><span class="mi">200000</span><span class="p">)</span>
</pre></div>
</div>
<p>To avoid convergence issues associated with poorly scaled variables
and/or constraints, we scale the variables and constraints corresponding
to the heater H101 and the reactor R101. Scaling factors for the flow
rates, temperature, pressure, etc. have been defined in the property
package: <code class="docutils literal notranslate"><span class="pre">hda_ideal_VLE.py</span></code> file. Here, we set scaling factors only
for the heat duty of the heater, the reaction extent, heat duty and
volume of the reactor.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set scaling factors for heat duty, reaction extent and volume</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">heat</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">rate_reaction_extent</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">heat</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">set_scaling_factor</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set the scaling factors for the remaining variables and all constraints</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">calculate_scaling_factors</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="p">)</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">calculate_scaling_factors</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: We have now defined all the feed conditions and the
inputs required for the unit models. The system should now have 0
degrees of freedom i.e. should be a square problem. Please check that
the degrees of freedom is 0.</p>
<p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Check the degrees of freedom</span>
<span class="nb">print</span><span class="p">(</span><span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>This subsection will demonstrate how to use the built-in sequential
decomposition tool to initialize our flowsheet.</p>
<p>Let us first create an object for the <code class="docutils literal notranslate"><span class="pre">SequentialDecomposition</span></code> and
specify our options for this.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="n">SequentialDecomposition</span><span class="p">()</span>
<span class="n">seq</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">select_tear_method</span> <span class="o">=</span> <span class="s2">&quot;heuristic&quot;</span>
<span class="n">seq</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">tear_method</span> <span class="o">=</span> <span class="s2">&quot;Wegstein&quot;</span>
<span class="n">seq</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">iterLim</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Using the SD tool</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">create_graph</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">heuristic_tear_set</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">tear_set_arcs</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;heuristic&quot;</span><span class="p">)</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">calculation_order</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<p>Which is the tear stream? Display tear set and order</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">heuristic_tear_set</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span><span class="o">.</span><span class="n">s03</span>
</pre></div>
</div>
<p>What sequence did the SD tool determine to solve this flowsheet with the
least number of tears?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span>
<span class="n">fs</span><span class="o">.</span><span class="n">R101</span>
<span class="n">fs</span><span class="o">.</span><span class="n">F101</span>
<span class="n">fs</span><span class="o">.</span><span class="n">S101</span>
<span class="n">fs</span><span class="o">.</span><span class="n">C101</span>
<span class="n">fs</span><span class="o">.</span><span class="n">M101</span>
</pre></div>
</div>
<p>The SequentialDecomposition tool has determined that the tear stream is
the mixer outlet (s03 in the Figure above). We will need to provide a
reasonable guess for this.</p>
<p>For the initial guess, we assume that the flowrate of the recycle stream
(s09) is zero. Consequently, the flow rate of the stream s03 is simply
the sum of the flowrates of the toluene feed and hydrogen feed streams.
Further, since the temperature and the pressure of both the toluene and
hydrogen feed streams are the same, we specify their values as the
initial guess for the temperature and pressure of the stream s03.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tear_guesses</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;flow_mol_phase_comp&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">):</span> <span class="mf">1e-5</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">):</span> <span class="mf">1e-5</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">):</span> <span class="mf">0.30</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">):</span> <span class="mf">0.02</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">):</span> <span class="mf">1e-5</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">):</span> <span class="mf">0.30</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;hydrogen&quot;</span><span class="p">):</span> <span class="mf">1e-5</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Liq&quot;</span><span class="p">,</span> <span class="s2">&quot;methane&quot;</span><span class="p">):</span> <span class="mf">1e-5</span><span class="p">},</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">303</span><span class="p">},</span>
        <span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">350000</span><span class="p">}}</span>

<span class="c1"># Pass the tear_guess to the SD tool</span>
<span class="n">seq</span><span class="o">.</span><span class="n">set_guesses_for</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">inlet</span><span class="p">,</span> <span class="n">tear_guesses</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we need to tell the tool how to initialize a particular unit. We
will be writing a python function which takes in a “unit” and calls the
initialize method on that unit.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
        <span class="n">unit</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<p>We are now ready to initialize our flowsheet in a sequential mode. Note
that we specifically set the iteration limit to be 3 as we are trying to
use this tool only to get a good set of initial values such that IPOPT
can then take over and solve this flowsheet for us.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">function</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">2022-03-16 23:24:24 [INFO] idaes.init.fs.H101.control_volume: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.H101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:24 [INFO] idaes.init.fs.R101.control_volume: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.R101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:24 [INFO] idaes.init.fs.F101.control_volume: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.F101: Initialization Complete: optimal - Optimal Solution Found
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:24 [INFO] idaes.init.fs.S101.purge_state: Initialization Complete
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>5e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>5e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>5e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a
    numeric value <cite>5e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:24 [INFO] idaes.init.fs.S101.recycle_state: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.S101: Initialization Step 2 Complete: optimal - Optimal Solution Found
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: State Released.
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator.properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:24 [INFO] idaes.init.fs.translator: Initialization Complete optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.C101.control_volume: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.C101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_out: State Released.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume: Initialization Complete
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102.control_volume.properties_in: State Released.
2022-03-16 23:24:24 [INFO] idaes.init.fs.H102: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101.mixed_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101: Initialization Complete: optimal - Optimal Solution Found
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.purge_state: Initialization Complete
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>7.999997599999522e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>7.999997599999522e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>7.999997599999522e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a
    numeric value <cite>7.999997599999522e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.recycle_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101: Initialization Step 2 Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101.mixed_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101: Initialization Complete: optimal - Optimal Solution Found
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.purge_state: Initialization Complete
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>7.99999999976048e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>7.99999999976048e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>7.99999999976048e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a
    numeric value <cite>7.99999999976048e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.recycle_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101: Initialization Step 2 Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101.mixed_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.R101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.F101: Initialization Complete: optimal - Optimal Solution Found
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.purge_state: Initialization Complete
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>7.999999999999976e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>7.999999999999976e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>7.999999999999976e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a
    numeric value <cite>7.999999999999976e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101.recycle_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.S101: Initialization Step 2 Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.C101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101.mixed_state: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.M101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101.control_volume: Initialization Complete
2022-03-16 23:24:25 [INFO] idaes.init.fs.H101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:26 [INFO] idaes.init.fs.R101.control_volume: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.R101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:26 [INFO] idaes.init.fs.F101.control_volume: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.F101: Initialization Complete: optimal - Optimal Solution Found
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.purge_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a numeric
    value <cite>2e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:26 [INFO] idaes.init.fs.S101.purge_state: Initialization Complete
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,benzene]' to a numeric
    value <cite>8e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,toluene]' to a numeric
    value <cite>8e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,methane]' to a numeric
    value <cite>8e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
WARNING (W1002): Setting Var
    'fs.S101.recycle_state[0.0].flow_mol_phase_comp[Liq,hydrogen]' to a
    numeric value <cite>8e-09</cite> outside the bounds (1e-08, 100).
    See also <a class="reference external" href="https://pyomo.readthedocs.io/en/stable/errors.html#w1002">https://pyomo.readthedocs.io/en/stable/errors.html#w1002</a>
2022-03-16 23:24:26 [INFO] idaes.init.fs.S101.recycle_state: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.S101: Initialization Step 2 Complete: optimal - Optimal Solution Found
2022-03-16 23:24:26 [INFO] idaes.init.fs.C101.control_volume: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.C101: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:26 [INFO] idaes.init.fs.M101.mixed_state: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.M101: Initialization Complete: optimal - Optimal Solution Found
WARNING: Wegstein failed to converge in 3 iterations
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: State Released.
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator.properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:26 [INFO] idaes.init.fs.translator: Initialization Complete optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_out: State Released.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume: Initialization Complete
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102.control_volume.properties_in: State Released.
2022-03-16 23:24:26 [INFO] idaes.init.fs.H102: Initialization Complete: optimal - Optimal Solution Found</pre>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: We have now initialized the flowsheet. Let us run
the flowsheet in a simulation mode to look at the results.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the solver object</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">()</span>

<span class="c1"># Solve the model</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2: nlp_scaling_method=gradient-based
tol=1e-06


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:     1097
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:      832

Total number of variables............................:      363
                     variables with only lower bounds:        8
                variables with lower and upper bounds:      155
                     variables with only upper bounds:        0
Total number of equality constraints.................:      363
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 6.34e+04 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 8.69e+03 1.40e+03  -1.0 2.00e+04    -  9.72e-01 4.67e-01H  1
   2  0.0000000e+00 1.29e+03 1.56e+03  -1.0 1.60e+04    -  9.80e-01 4.90e-01h  1
   3  0.0000000e+00 9.71e+02 1.48e+05  -1.0 1.40e+04    -  9.90e-01 4.94e-01h  1
   4  0.0000000e+00 5.96e+02 1.91e+07  -1.0 8.49e+03    -  1.00e+00 5.27e-01h  1
   5  0.0000000e+00 1.16e+02 2.65e+11  -1.0 4.37e+03    -  1.00e+00 9.86e-01h  1
   6  0.0000000e+00 5.42e+01 1.91e+09  -1.0 1.58e+02    -  1.00e+00 5.31e-01h  1
   7  0.0000000e+00 5.22e-01 2.70e+11  -1.0 7.42e+01    -  1.00e+00 9.90e-01h  1
   8  0.0000000e+00 1.59e-02 6.29e+09  -1.0 7.09e-01    -  1.00e+00 1.00e+00h  1
   9  0.0000000e+00 7.45e-09 6.37e+03  -1.0 1.50e-07    -  1.00e+00 1.00e+00h  1
Cannot recompute multipliers for feasibility problem.  Error in eq_mult_calculator

Number of Iterations....: 9

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0331968839446240e+11    1.0331968839446240e+11
Constraint violation....:   2.9103830456733704e-11    7.4505805969238281e-09
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   2.9103830456733704e-11    1.0331968839446240e+11


Number of objective function evaluations             = 11
Number of objective gradient evaluations             = 10
Number of equality constraint evaluations            = 11
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 10
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 9
Total CPU secs in IPOPT (w/o function evaluations)   =      0.015
Total CPU secs in NLP function evaluations           =      0.001

EXIT: Optimal Solution Found.</pre>
</section>
<section id="add-distillation-column">
<h3>Add distillation column<a class="headerlink" href="#add-distillation-column" title="Permalink to this headline">¶</a></h3>
<p>As mentioned earlier, the <code class="docutils literal notranslate"><span class="pre">SequentialDecomposition</span></code> tool currently
does not support the distillation column model. Thus, we have not
included the distillation column in the flowsheet. Now that we have a
converged flowsheet, we will add the distillation column and simulate
the entire flowsheet.</p>
<p>In the following, we will - Add the distillation column - Connect it to
the heater - Add the necessary equality constraints - Propogate the
state variable information from the outlet of the heater to the inlet of
the distillation column - Fix the degrees of freedom of the distillation
block (reflux ratio, boilup ratio, and condenser pressure) - Initialize
the distillation block.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add distillation column to the flowsheet</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span> <span class="o">=</span> <span class="n">TrayColumn</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;number_of_trays&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="s2">&quot;feed_tray_location&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                        <span class="s2">&quot;condenser_type&quot;</span><span class="p">:</span>
                            <span class="n">CondenserType</span><span class="o">.</span><span class="n">totalCondenser</span><span class="p">,</span>
                        <span class="s2">&quot;condenser_temperature_spec&quot;</span><span class="p">:</span>
                            <span class="n">TemperatureSpec</span><span class="o">.</span><span class="n">atBubblePoint</span><span class="p">,</span>
                        <span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">BT_params</span><span class="p">})</span>

<span class="c1"># Connect the outlet from the heater H102 to the distillation column</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s11</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="p">,</span>
               <span class="n">destination</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">feed</span><span class="p">)</span>

<span class="c1"># Add the necessary equality constraints</span>
<span class="n">TransformationFactory</span><span class="p">(</span><span class="s2">&quot;network.expand_arcs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Propagate the state</span>
<span class="n">propagate_state</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s11</span><span class="p">)</span>

<span class="c1"># Fix the reflux ratio, boilup ratio, and the condenser pressure</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">reflux_ratio</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">boilup_ratio</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">condenser_pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>

<span class="c1"># Initialize the distillation column</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[1] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[1] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[2] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[2] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[3] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[3] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[4] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.rectification_section[4] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block fs.D101.feed_tray
    with a new Component (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This
    is usually indicative of a modelling error. To avoid this warning, use
    block.del_component() and block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block fs.D101.feed_tray
    with a new Component (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This
    is usually indicative of a modelling error. To avoid this warning, use
    block.del_component() and block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[6] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[6] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[7] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[7] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[8] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[8] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[9] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[9] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _temperature_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[10] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
WARNING: Implicitly replacing the Component attribute _pressure_ref
    (type=&lt;class &#39;pyomo.core.base.var.IndexedVar&#39;&gt;) on block
    fs.D101.stripping_section[10] with a new Component (type=&lt;class
    &#39;pyomo.core.base.var.IndexedVar&#39;&gt;). This is usually indicative of a
    modelling error. To avoid this warning, use block.del_component() and
    block.add_component().
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101: Begin initialization.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray: Begin initialization.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:26 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_liq: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.feed_tray.properties_in_vap: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_out: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume: Initialization Complete
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser: Initialization Complete, optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.condenser.control_volume.properties_in: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler: Initialization Complete, optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.reboiler.control_volume.properties_in: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1]: Begin initialization.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_vap: State Released.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2]: Begin initialization.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:27 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_vap: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[2].properties_in_liq: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3]: Begin initialization.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_vap: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[3].properties_in_liq: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4]: Begin initialization.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_liq: State Released.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6]: Begin initialization.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:28 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_vap: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7]: Begin initialization.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_vap: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[7].properties_in_liq: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8]: Begin initialization.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_vap: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[8].properties_in_liq: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9]: Begin initialization.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: State Released.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:29 [INFO] idaes.init.fs.D101.stripping_section[9]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[9]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[9]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_vap: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[9].properties_in_liq: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10]: Begin initialization.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Step 1 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Step 2 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Step 3 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Step 4 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Step 5 optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_out: Initialization Complete: optimal - Optimal Solution Found
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10]: Mass balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10]: Mass and energy balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10]: Mass, energy and pressure balance solve optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10]: Initialization complete, status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_liq: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101: Rectification section initialization status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101: Stripping section initialization status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.rectification_section[4].properties_in_vap: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[6].properties_in_liq: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101: Column section initialization status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.rectification_section[1].properties_in_liq: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101: Column section + Condenser initialization status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.stripping_section[10].properties_in_vap: State Released.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101: Column section + Condenser + Reboiler initialization status optimal - Optimal Solution Found.
2022-03-16 23:24:30 [INFO] idaes.init.fs.D101.feed_tray.properties_in_feed: State Released.
</pre></div>
</div>
</section>
</section>
<section id="adding-expressions-to-compute-capital-and-operating-costs">
<h2>Adding expressions to compute capital and operating costs<a class="headerlink" href="#adding-expressions-to-compute-capital-and-operating-costs" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will add a few Expressions that allow us to evaluate
the performance. Expressions provide a convenient way of calculating
certain values that are a function of the variables defined in the
model. For more details on Expressions, please refer to:
<a class="reference external" href="https://pyomo.readthedocs.io/en/latest/pyomo_modeling_components/Expressions.html">https://pyomo.readthedocs.io/en/latest/pyomo_modeling_components/Expressions.html</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Expression to compute the total cooling cost</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cooling_cost</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="mf">0.25e-7</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
                                <span class="mf">0.2e-7</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Expression to compute the total heating cost</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heating_cost</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="mf">2.2e-7</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                                <span class="mf">1.2e-7</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                                <span class="mf">1.9e-7</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Expression to compute the total operating cost</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span>
                                <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heating_cost</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cooling_cost</span><span class="p">)))</span>

<span class="c1"># Expression to compute the total capital cost</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="mf">1e5</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<section id="solve-the-entire-flowsheet">
<h3>Solve the entire flowsheet<a class="headerlink" href="#solve-the-entire-flowsheet" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2: nlp_scaling_method=gradient-based
tol=1e-06


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:     4040
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     2038

Total number of variables............................:     1169
                     variables with only lower bounds:      112
                variables with lower and upper bounds:      365
                     variables with only upper bounds:        0
Total number of equality constraints.................:     1169
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 6.60e+04 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 8.70e+03 1.50e+03  -1.0 3.69e+04    -  9.71e-01 4.62e-01H  1
   2  0.0000000e+00 1.53e+03 1.56e+03  -1.0 6.75e+03    -  9.77e-01 4.89e-01h  1
   3  0.0000000e+00 1.36e+03 1.48e+05  -1.0 9.37e+03    -  9.90e-01 4.94e-01h  1
   4  0.0000000e+00 8.18e+02 1.90e+07  -1.0 6.13e+03    -  1.00e+00 5.26e-01h  1
   5  0.0000000e+00 1.48e+02 2.64e+11  -1.0 3.26e+03    -  1.00e+00 9.86e-01h  1
   6  0.0000000e+00 6.95e+01 1.88e+09  -1.0 1.44e+02    -  1.00e+00 5.32e-01h  1
   7  0.0000000e+00 6.69e-01 2.71e+11  -1.0 6.73e+01    -  1.00e+00 9.90e-01h  1
   8  0.0000000e+00 1.45e-02 5.49e+09  -1.0 6.44e-01    -  1.00e+00 1.00e+00h  1
   9  0.0000000e+00 2.24e-08 4.66e+03  -1.0 2.05e-07    -  1.00e+00 1.00e+00h  1
Cannot recompute multipliers for feasibility problem.  Error in eq_mult_calculator

Number of Iterations....: 9

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.0323515799592938e+11    1.0323515799592938e+11
Constraint violation....:   2.9103830456733704e-11    2.2351741790771484e-08
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   2.9103830456733704e-11    1.0323515799592938e+11


Number of objective function evaluations             = 11
Number of objective gradient evaluations             = 10
Number of equality constraint evaluations            = 11
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 10
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 9
Total CPU secs in IPOPT (w/o function evaluations)   =      0.042
Total CPU secs in NLP function evaluations           =      0.005

EXIT: Optimal Solution Found.</pre>
<pre class="literal-block">{'Problem': [{'Lower bound': -inf, 'Upper bound': inf, 'Number of objectives': 1, 'Number of constraints': 1169, 'Number of variables': 1169, 'Sense': 'unknown'}], 'Solver': [{'Status': 'ok', 'Message': 'Ipopt 3.13.2\x3a Optimal Solution Found', 'Termination condition': 'optimal', 'Id': 0, 'Error rc': 0, 'Time': 0.06271195411682129}], 'Solution': [OrderedDict([('number of solutions', 0), ('number of solutions displayed', 0)])]}</pre>
</section>
</section>
<section id="analyze-the-results-of-the-square-problem">
<h2>Analyze the Results of the Square Problem<a class="headerlink" href="#analyze-the-results-of-the-square-problem" title="Permalink to this headline">¶</a></h2>
<p>How much is the total cost (operating cost + capital cost), operating
cost, capital cost, benzene purity in the distillate from the
distilation column, and conversion of toluene in the reactor?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;operating cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;capital cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distillate flowrate = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">distillate</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]()),</span> <span class="s1">&#39;mol/s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Benzene purity = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span>\
    <span class="n">condenser</span><span class="o">.</span><span class="n">distillate</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Residue flowrate = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">bottoms</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]()),</span> <span class="s1">&#39;mol/s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Toluene purity = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span>\
    <span class="n">reboiler</span><span class="o">.</span><span class="n">bottoms</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conversion = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overhead benzene loss in F101 = &#39;</span><span class="p">,</span> \
    <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">])</span> <span class="o">/</span> \
        <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>total cost = $ 442297.7468818148
operating cost = $ 427593.0066973474
capital cost = $ 14704.74018446741

Distillate flowrate =  0.16202588062180265 mol/s
Benzene purity =  89.51393273342444 %
Residue flowrate =  0.10509317979151009 mol/s
Toluene purity =  43.32375727420053 %

Conversion =  75.0 %

Overhead benzene loss in F101 =  42.16193848360319 %
</pre></div>
</div>
<p>Get the state of the streams entering and leaving the reactor R101</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">R101</span>                                                             <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>       <span class="p">:</span> <span class="n">Value</span>   <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
    <span class="n">Heat</span> <span class="n">Duty</span> <span class="p">:</span>  <span class="mf">0.0000</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
       <span class="n">Volume</span> <span class="p">:</span> <span class="mf">0.14705</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                                               <span class="n">Inlet</span>     <span class="n">Outlet</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>  <span class="mf">1.2993e-07</span> <span class="mf">1.2993e-07</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>  <span class="mf">8.4147e-07</span> <span class="mf">8.4147e-07</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>  <span class="mf">1.0000e-08</span> <span class="mf">1.0000e-08</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span> <span class="mf">1.0000e-08</span> <span class="mf">1.0000e-08</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>     <span class="mf">0.11936</span>    <span class="mf">0.35374</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>     <span class="mf">0.31252</span>   <span class="mf">0.078129</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>      <span class="mf">1.0377</span>     <span class="mf">1.2721</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span>    <span class="mf">0.56260</span>    <span class="mf">0.32821</span>
    <span class="n">temperature</span>                                 <span class="mf">600.00</span>     <span class="mf">771.85</span>
    <span class="n">pressure</span>                                <span class="mf">3.5000e+05</span> <span class="mf">3.5000e+05</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
<p>Get the state of the streams entering and leaving the reactor R101</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">F101</span>                                                             <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>             <span class="p">:</span> <span class="n">Value</span>   <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
          <span class="n">Heat</span> <span class="n">Duty</span> <span class="p">:</span> <span class="o">-</span><span class="mf">70343.</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">Pressure</span> <span class="n">Change</span> <span class="p">:</span>  <span class="mf">0.0000</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                                               <span class="n">Inlet</span>    <span class="n">Vapor</span> <span class="n">Outlet</span>  <span class="n">Liquid</span> <span class="n">Outlet</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>  <span class="mf">1.2993e-07</span>   <span class="mf">1.0000e-08</span>       <span class="mf">0.20460</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>  <span class="mf">8.4147e-07</span>   <span class="mf">1.0000e-08</span>      <span class="mf">0.062520</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>  <span class="mf">1.0000e-08</span>   <span class="mf">1.0000e-08</span>    <span class="mf">2.6712e-07</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span> <span class="mf">1.0000e-08</span>   <span class="mf">1.0000e-08</span>    <span class="mf">2.6712e-07</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>     <span class="mf">0.35374</span>      <span class="mf">0.14915</span>    <span class="mf">1.0000e-08</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>    <span class="mf">0.078129</span>     <span class="mf">0.015610</span>    <span class="mf">1.0000e-08</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>      <span class="mf">1.2721</span>       <span class="mf">1.2721</span>    <span class="mf">1.0000e-08</span>
    <span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span>    <span class="mf">0.32821</span>      <span class="mf">0.32821</span>    <span class="mf">1.0000e-08</span>
    <span class="n">temperature</span>                                 <span class="mf">771.85</span>       <span class="mf">325.00</span>        <span class="mf">325.00</span>
    <span class="n">pressure</span>                                <span class="mf">3.5000e+05</span>   <span class="mf">3.5000e+05</span>    <span class="mf">3.5000e+05</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
<p>Next, let’s look at how much benzene we are loosing with the light gases
out of F101. IDAES has tools for creating stream tables based on the
<code class="docutils literal notranslate"><span class="pre">Arcs</span></code> and/or <code class="docutils literal notranslate"><span class="pre">Ports</span></code> in a flowsheet. Let us create and print a
simple stream table showing the stream leaving the reactor and the vapor
stream from F101.</p>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: How much benzene are we loosing in the F101 vapor
outlet stream?</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">idaes.core.util.tables</span> <span class="kn">import</span> <span class="n">create_stream_table_dataframe</span><span class="p">,</span> <span class="n">stream_table_dataframe_to_string</span>

<span class="n">st</span> <span class="o">=</span> <span class="n">create_stream_table_dataframe</span><span class="p">({</span><span class="s2">&quot;Reactor&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s05</span><span class="p">,</span> <span class="s2">&quot;Light Gases&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">s06</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stream_table_dataframe_to_string</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                          <span class="n">Reactor</span>   <span class="n">Light</span> <span class="n">Gases</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>  <span class="mf">1.2993e-07</span>  <span class="mf">1.0000e-08</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>  <span class="mf">8.4147e-07</span>  <span class="mf">1.0000e-08</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>  <span class="mf">1.0000e-08</span>  <span class="mf">1.0000e-08</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span> <span class="mf">1.0000e-08</span>  <span class="mf">1.0000e-08</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">)</span>     <span class="mf">0.35374</span>     <span class="mf">0.14915</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">)</span>    <span class="mf">0.078129</span>    <span class="mf">0.015610</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;methane&#39;</span><span class="p">)</span>      <span class="mf">1.2721</span>      <span class="mf">1.2721</span>
<span class="n">flow_mol_phase_comp</span> <span class="p">(</span><span class="s1">&#39;Vap&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrogen&#39;</span><span class="p">)</span>    <span class="mf">0.32821</span>     <span class="mf">0.32821</span>
<span class="n">temperature</span>                                 <span class="mf">771.85</span>      <span class="mf">325.00</span>
<span class="n">pressure</span>                                <span class="mf">3.5000e+05</span>  <span class="mf">3.5000e+05</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: You can querry additional variables here if you
like.</p>
<p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
</section>
</section>
<section id="optimization">
<h1>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h1>
<p>We saw from the results above that the total operating cost for the base
case was $442,297 per year. We are producing 0.162 mol/s of benzene at a
purity of 89.5%. However, we are losing around 43.3% of benzene in F101
vapor outlet stream.</p>
<p>Let us try to minimize this cost such that: - we are producing at least
0.18 mol/s of benzene as distillate i.e. our product stream - purity of
benzene i.e. the mole fraction of benzene in the distillate is at least
99% - restricting the benzene loss in F101 vapor outlet to less than 20%</p>
<p>For this problem, our decision variables are as follows: - H101 outlet
temperature - R101 outlet temperature - F101 outlet temperature - H102
outlet temperature - Condenser pressure - reflux ratio - boilup ratio</p>
<p>Let us declare our objective function for this problem.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we need to unfix the decision variables as we had solved a square
problem (degrees of freedom = 0) until now.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">condenser_pressure</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">reflux_ratio</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">boilup_ratio</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Let us now unfix the remaining variable: the
temperature of the outlet from H102</p>
<p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Unfix the temperature of the outlet from H102</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
</pre></div>
</div>
<p>Next, we need to set bounds on these decision variables to values shown
below:</p>
<ul class="simple">
<li><p>H101 outlet temperature [500, 600] K</p></li>
<li><p>R101 outlet temperature [600, 900] K</p></li>
<li><p>F101 outlet temperature [298, 450] K</p></li>
<li><p>H102 outlet temperature [350, 400] K</p></li>
<li><p>D101 condenser pressure [101325, 150000] Pa</p></li>
<li><p>D101 reflux ratio [0.1, 5]</p></li>
<li><p>D101 boilup ratio [0.1, 5]</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set bounds on the temperature of the outlet from H101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>

<span class="c1"># Set bounds on the temperature of the outlet from R101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>

<span class="c1"># Set bounds on the volume of the reactor R101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set bounds on the temperature of the vapor outlet from F101</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">298</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mf">450.0</span><span class="p">)</span>

<span class="c1"># Set bounds on the temperature of the outlet from H102</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>

<span class="c1"># Set bounds on the pressure inside the condenser</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">condenser_pressure</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">condenser_pressure</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Now, set the bounds for the D101 reflux ratio and
boilup ratio.</p>
<p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Set bounds on the reflux ratio</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">reflux_ratio</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">reflux_ratio</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Todo: Set bounds on the boilup ratio</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">boilup_ratio</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">boilup_ratio</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, the only things left to define are our constraints on overhead loss
in F101, distillate flowrate and its purity. Let us first look at
defining a constraint for the overhead loss in F101 where we are
restricting the benzene leaving the vapor stream to less than 20 % of
the benzene available in the reactor outlet.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure that the overhead loss of benzene from F101 &lt;= 20%</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">overhead_loss</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">&lt;=</span>
    <span class="mf">0.20</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Inline Exercise: Now, add the constraint such that we are producing
at least 0.18 mol/s of benzene in the product stream which is the
distillate of D101. Let us name this constraint as m.fs.product_flow.</p>
<p>Use Shift+Enter to run the cell once you have typed in your code.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Add minimum product flow constraint</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">product_flow</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">distillate</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.18</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us add the final constraint on product purity or the mole fraction
of benzene in the distillate such that it is at least greater than 99%.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">product_purity</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span>
    <span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span>
    <span class="n">distillate</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.99</span><span class="p">)</span>
</pre></div>
</div>
<p>We have now defined the optimization problem and we are now ready to
solve this problem.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2: nlp_scaling_method=gradient-based
tol=1e-06


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:     4071
Number of nonzeros in inequality constraint Jacobian.:        5
Number of nonzeros in Lagrangian Hessian.............:     2051

Total number of variables............................:     1176
                     variables with only lower bounds:      113
                variables with lower and upper bounds:      372
                     variables with only upper bounds:        0
Total number of equality constraints.................:     1169
Total number of inequality constraints...............:        3
        inequality constraints with only lower bounds:        2
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        1

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  4.4229775e+05 2.99e+05 9.90e+01  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  4.3753513e+05 2.91e+05 1.28e+02  -1.0 3.08e+06    -  3.58e-01 2.40e-02f  1
   2  4.3544761e+05 2.78e+05 1.56e+02  -1.0 1.77e+06    -  3.32e-01 4.74e-02h  1
   3  4.2823909e+05 2.21e+05 4.44e+02  -1.0 2.98e+06    -  2.95e-02 1.34e-01h  1
   4  4.2248549e+05 1.45e+05 1.41e+03  -1.0 7.00e+06    -  5.13e-01 2.03e-01h  1
   5  4.2192160e+05 8.16e+04 1.68e+04  -1.0 6.06e+06    -  5.96e-01 4.28e-01h  1
   6  4.2572160e+05 4.72e+04 8.66e+05  -1.0 4.33e+06    -  9.26e-01 4.79e-01h  1
   7  4.3256077e+05 2.06e+04 1.52e+08  -1.0 2.53e+06    -  9.90e-01 5.69e-01h  1
   8  4.4327786e+05 5.80e+03 1.85e+12  -1.0 1.23e+06    -  5.97e-01 9.83e-01h  1
   9  4.4285622e+05 5.81e+03 1.83e+12  -1.0 1.71e+07    -  3.60e-03 8.72e-03h  4
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10  4.4279032e+05 5.80e+03 1.83e+12  -1.0 7.94e+07    -  2.87e-03 4.53e-04h  6
  11  4.4272626e+05 5.80e+03 1.75e+12  -1.0 6.85e+07    -  4.34e-01 5.14e-04h  6
  12  4.4247571e+05 5.21e+03 1.43e+12  -1.0 2.32e+06    -  1.48e-01 1.47e-01h  2
  13  4.4237906e+05 5.04e+03 1.35e+12  -1.0 6.42e+05    -  2.89e-01 3.51e-02h  5
  14  4.4103908e+05 4.80e+03 1.30e+12  -1.0 4.69e+05    -  2.56e-01 3.79e-02H  1
  15  4.4204736e+05 4.15e+03 8.55e+11  -1.0 4.73e+05    -  2.19e-01 3.07e-01h  2
  16  4.4209153e+05 4.04e+03 8.10e+11  -1.0 4.16e+04    -  1.00e+00 2.76e-02h  6
  17  4.4221942e+05 3.59e+03 7.23e+11  -1.0 1.37e+05    -  5.82e-01 1.05e-01H  1
  18  4.4847962e+05 8.44e+01 6.39e+09  -1.0 3.06e+05    -  5.05e-01 9.90e-01h  1
  19  4.4851834e+05 8.44e+01 6.96e+09  -1.0 2.74e+05    -  2.71e-02 5.80e-04H  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20  4.4827002e+05 4.34e+01 4.22e+09  -1.0 7.71e+04    -  3.35e-01 5.00e-01h  2
  21  4.4824238e+05 4.34e+01 4.13e+09  -1.0 5.33e+05    -  3.24e-03 7.76e-04f  8
  22  4.4822822e+05 3.42e-01 1.05e+10  -1.0 2.81e+02  -4.0 1.00e+00 1.00e+00h  1
  23  4.4778656e+05 1.65e+00 1.03e+10  -1.0 3.85e+03    -  4.34e-01 1.00e+00F  1
  24  4.4767017e+05 3.43e+00 1.16e+09  -1.0 3.30e+05    -  1.00e+00 1.18e-02f  6
  25  4.4761264e+05 4.59e+00 1.15e+09  -1.0 3.31e+05    -  1.28e-01 8.83e-03f  7
  26  4.4755650e+05 5.73e+00 1.08e+09  -1.0 3.16e+05    -  1.00e+00 6.43e-03f  7
  27  4.4751154e+05 6.32e+00 1.04e+09  -1.0 2.77e+05    -  2.15e-01 1.56e-02h  7
  28  4.4397623e+05 4.33e+03 4.49e+08  -1.0 2.72e+05    -  1.00e+00 5.42e-01f  1
  29  4.4257967e+05 6.72e+01 2.33e+08  -1.0 9.79e+02  -4.5 8.46e-02 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30  4.4350438e+05 1.80e+01 6.91e+05  -1.0 8.06e+02  -5.0 1.00e+00 7.32e-01h  1
  31  4.4347402e+05 1.46e+01 9.80e+10  -2.5 2.70e+02  -5.4 1.00e+00 1.91e-01h  1
  32  4.4322858e+05 7.20e+00 4.84e+10  -2.5 2.31e+02  -5.9 1.00e+00 5.06e-01h  1
  33  4.4317829e+05 1.70e+00 8.70e+06  -2.5 1.50e+02  -6.4 1.00e+00 1.00e+00h  1
  34  4.4196325e+05 4.63e+02 1.18e+07  -2.5 7.74e+06    -  8.23e-02 4.79e-02f  1
  35  4.4058760e+05 1.31e+03 1.21e+08  -2.5 5.32e+06    -  1.00e+00 8.02e-02f  1
  36  4.3472139e+05 5.74e+04 7.00e+04  -2.5 2.88e+04    -  1.00e+00 1.00e+00f  1
  37  4.3857271e+05 9.29e+02 9.47e+03  -2.5 1.65e+04    -  1.00e+00 1.00e+00h  1
  38  4.3829691e+05 6.38e+02 1.29e+02  -2.5 7.23e+02    -  1.00e+00 1.00e+00h  1
  39  4.3830434e+05 2.39e-01 7.70e-02  -2.5 1.27e+01    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40  4.3826365e+05 1.13e+02 6.79e+07  -5.7 1.44e+04    -  9.90e-01 9.71e-01f  1
  41  4.3826912e+05 2.60e-01 1.41e+03  -5.7 1.08e+01    -  1.00e+00 1.00e+00h  1
  42  4.3826913e+05 1.56e-07 6.14e-05  -5.7 4.81e-02    -  1.00e+00 1.00e+00h  1
  43  4.3826911e+05 5.41e-05 1.17e+00  -8.0 8.77e+00    -  1.00e+00 1.00e+00h  1
  44  4.3826911e+05 3.73e-08 2.33e-07  -8.0 2.32e-04    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 44

                                   (scaled)                 (unscaled)
Objective...............:   4.3826911213246251e+02    4.3826911213246250e+05
Dual infeasibility......:   2.3320091401956337e-07    2.3320091401956335e-04
Constraint violation....:   5.8207660913467407e-11    3.7252902984619141e-08
Complementarity.........:   9.0909431766740231e-09    9.0909431766740226e-06
Overall NLP error.......:   8.3642301312361550e-09    2.3320091401956335e-04


Number of objective function evaluations             = 125
Number of objective gradient evaluations             = 45
Number of equality constraint evaluations            = 125
Number of inequality constraint evaluations          = 125
Number of equality constraint Jacobian evaluations   = 45
Number of inequality constraint Jacobian evaluations = 45
Number of Lagrangian Hessian evaluations             = 44
Total CPU secs in IPOPT (w/o function evaluations)   =      0.214
Total CPU secs in NLP function evaluations           =      0.036

EXIT: Optimal Solution Found.</pre>
<section id="optimization-results">
<h2>Optimization Results<a class="headerlink" href="#optimization-results" title="Permalink to this headline">¶</a></h2>
<p>Display the results and product specifications</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;operating cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">operating_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;capital cost = $&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">capital_cost</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distillate flowrate = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">condenser</span><span class="o">.</span><span class="n">distillate</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]()),</span> <span class="s1">&#39;mol/s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Benzene purity = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span>\
    <span class="n">condenser</span><span class="o">.</span><span class="n">distillate</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Residue flowrate = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span><span class="n">reboiler</span><span class="o">.</span><span class="n">bottoms</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]()),</span> <span class="s1">&#39;mol/s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Toluene purity = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">D101</span><span class="o">.</span>\
    <span class="n">reboiler</span><span class="o">.</span><span class="n">bottoms</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conversion = &#39;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">conversion</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overhead benzene loss in F101 = &#39;</span><span class="p">,</span> \
    <span class="mi">100</span> <span class="o">*</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">])</span> <span class="o">/</span> \
        <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">flow_mol_phase_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Vap&quot;</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]),</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>total cost = $ 438269.1121324626
operating cost = $ 408342.35270371474
capital cost = $ 29926.759428747868

Distillate flowrate =  0.17999999002647057 mol/s
Benzene purity =  98.99999900051326 %
Residue flowrate =  0.1084428638896572 mol/s
Toluene purity =  15.859460669684665 %

Conversion =  93.28983757156178 %

Overhead benzene loss in F101 =  17.444853021293376 %
</pre></div>
</div>
<p>Display optimal values for the decision variables</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Values&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H101 outlet temperature = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R101 outlet temperature = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">R101</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F101 outlet temperature = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">F101</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H102 outlet temperature = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">H102</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Optimal</span> <span class="n">Values</span>

<span class="n">H101</span> <span class="n">outlet</span> <span class="n">temperature</span> <span class="o">=</span>  <span class="mf">568.7845207063735</span> <span class="n">K</span>

<span class="n">R101</span> <span class="n">outlet</span> <span class="n">temperature</span> <span class="o">=</span>  <span class="mf">790.0196711917399</span> <span class="n">K</span>

<span class="n">F101</span> <span class="n">outlet</span> <span class="n">temperature</span> <span class="o">=</span>  <span class="mf">298.1499971259889</span> <span class="n">K</span>

<span class="n">H102</span> <span class="n">outlet</span> <span class="n">temperature</span> <span class="o">=</span>  <span class="mf">368.7855671646761</span> <span class="n">K</span>
</pre></div>
</div>
<section id="key-takeaways">
<h3>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permalink to this headline">¶</a></h3>
<p>Observe that the optimization was able to reduce the yearly operating
cost from \$427,593 to \$408,342 (~4.5%). However, the amortized
capital cost more than doubled from \$14,704 to \$29,927 due to the
need to increase the conversion in the reactor (from 75% to 93%) to meet
the production and purity constraints.</p>
<p>Further, observe that the product flow rate and product purity are at
their minimum values (0.18 mol/s and 99%, respectively). This is
expected as increasing recovery would require more energy and cost to
purify the product.</p>
<p>Finally, observe that the operating temperature of the flash (F101) is
almost at its lower bound. This helps in minimizing the amount of
benzene in the vapor stream leaving the flash.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>