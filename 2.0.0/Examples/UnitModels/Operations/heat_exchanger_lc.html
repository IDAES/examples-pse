<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heat Exchanger Lumped-Capacitance Unit Model with Two Property Packages &mdash; IDAES v2.0.0 Examples</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Heat Exchanger NTU Unit Model with Aqueous MEA System" href="heat_exchanger_NTU.html" />
    <link rel="prev" title="Heat Exchanger 1D Unit Model with Two Property Packages" href="heat_exchanger_1D.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            IDAES Examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Flowsheets/index.html">Flowsheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../MatOpt/index.html">MatOpt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SurrMod/index.html">Surrogate modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Tools/index.html">Tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Unit models</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Operations</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="compressor_doc.html">Compressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="feed_doc.html">Feed</a></li>
<li class="toctree-l4"><a class="reference internal" href="feed_flash_doc.html">Feed Flash</a></li>
<li class="toctree-l4"><a class="reference internal" href="flash_doc.html">Flash</a></li>
<li class="toctree-l4"><a class="reference internal" href="heater_doc.html">Heater</a></li>
<li class="toctree-l4"><a class="reference internal" href="heat_exchanger_0D.html">Heat Exchanger 0D</a></li>
<li class="toctree-l4"><a class="reference internal" href="heat_exchanger_1D.html">Heat Exchanger 1D</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Heat Exchanger lc</a></li>
<li class="toctree-l4"><a class="reference internal" href="heat_exchanger_NTU.html">Heat Exchanger NTU</a></li>
<li class="toctree-l4"><a class="reference internal" href="mixer_doc.html">Mixer</a></li>
<li class="toctree-l4"><a class="reference internal" href="product_doc.html">Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="pump_doc.html">Pump</a></li>
<li class="toctree-l4"><a class="reference internal" href="separator_doc.html">Separator</a></li>
<li class="toctree-l4"><a class="reference internal" href="statejunction_doc.html">Statejunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="translator_doc.html">Translator</a></li>
<li class="toctree-l4"><a class="reference internal" href="turbine_doc.html">Turbine</a></li>
<li class="toctree-l4"><a class="reference internal" href="valve_doc.html">Valve</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Reactors/index.html">Unit models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Pecos/index.html">Pecos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorials/index.html">IDAES Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IDAES Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Unit models</a></li>
          <li class="breadcrumb-item"><a href="index.html">Operations</a></li>
      <li class="breadcrumb-item active">Heat Exchanger Lumped-Capacitance Unit Model with Two Property Packages</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/Examples/UnitModels/Operations/heat_exchanger_lc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="heat-exchanger-lumped-capacitance-unit-model-with-two-property-packages">
<h1>Heat Exchanger Lumped-Capacitance Unit Model with Two Property Packages<a class="headerlink" href="#heat-exchanger-lumped-capacitance-unit-model-with-two-property-packages" title="Permalink to this heading">¶</a></h1>
<img alt="../../../_images/heat_exchanger_4.svg" src="../../../_images/heat_exchanger_4.svg" /><p><strong>Problem Statement</strong>: In this example, we will be heating a
benzene-toluene mixture using steam.</p>
<p><strong>Tube Side Inlet</strong></p>
<p>Flow Rate = 250 mol/s</p>
<p>Mole fraction (Benzene) = 0.4</p>
<p>Mole fraction (Toluene) = 0.6</p>
<p>Pressure = 101325 Pa</p>
<p>Temperature = 380 K</p>
<p><strong>Shell Side Inlet</strong></p>
<p>Flow Rate = 100 mol/s</p>
<p>Mole fraction (Steam) = 1</p>
<p>Pressure = 101325 Pa</p>
<p>Temperature = 400 K</p>
<p>The 0D lumped-capacitance heat exchanger unit model makes the assumption
that the temperature difference bewtween discrete “lumps” in the heat
exchanger is negligible. Likewise, this model can be useful for
transient simulations in which temperature gradients within the heat
exchanger can be ignored. This example will demonstrate the simulation
of the lumped-capacitance heat exchanger by fixing the following degrees
of freedom: - heat transfer area - overall heat transfer coefficients
(one for cold-side and one for hot-side)</p>
<p>The IDAES library’s <code class="docutils literal notranslate"><span class="pre">HeatExchangerLumpedCapacitance</span></code> is modelled after
the heat exchanger 0D model and has added the capabilities of supporting
a wall temperature as well as heat holdup for transient simulations;
more details on the lumped capacitance heat exchanger may be found here:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/heat_exchanger_lc.html">https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/heat_exchanger_lc.html</a>.</p>
<p>IDAES documentation reference for the simpler heat exchanger 0D model:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/heat_exchanger.html">https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/heat_exchanger.html</a></p>
<section id="importing-necessary-tools">
<h2>Importing necessary tools<a class="headerlink" href="#importing-necessary-tools" title="Permalink to this heading">¶</a></h2>
<p>First, import the required IDAES and Pyomo modules. Note that the
hot-side (shell) and cold-side (tube) properties leverage separate
property packages:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import pyomo package</span>
<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">ConcreteModel</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span>

<span class="c1"># Import idaes logger to set output levels</span>
<span class="kn">import</span> <span class="nn">idaes.logger</span> <span class="k">as</span> <span class="nn">idaeslog</span>

<span class="c1"># Import the main FlowsheetBlock from IDAES. The flowsheet block will contain the unit model</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>

<span class="c1"># Import the IAPWS property package to create a properties block for steam in the flowsheet</span>
<span class="kn">from</span> <span class="nn">idaes.models.properties</span> <span class="kn">import</span> <span class="n">iapws95</span>

<span class="kn">from</span> <span class="nn">idaes.models.properties.iapws95</span> <span class="kn">import</span> <span class="n">htpx</span>

<span class="kn">from</span> <span class="nn">idaes.models.properties.modular_properties</span> <span class="kn">import</span> <span class="n">GenericParameterBlock</span>

<span class="c1"># Import the BT_ideal property package to create a properties block for the tube side in the flowsheet</span>
<span class="kn">from</span> <span class="nn">idaes.models.properties.modular_properties.examples.BT_ideal</span> \
    <span class="kn">import</span> <span class="nn">configuration</span>

<span class="c1">#Import the degrees_of_freedom function from the idaes.core.util.model_statistics package</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.model_statistics</span> <span class="kn">import</span> <span class="n">degrees_of_freedom</span>

<span class="c1">#Import the default IPOPT solver</span>
<span class="kn">from</span> <span class="nn">idaes.core.solvers</span> <span class="kn">import</span> <span class="n">get_solver</span>

<span class="c1">#Import a heat exchanger unit</span>
<span class="kn">from</span> <span class="nn">idaes.models.unit_models</span> <span class="kn">import</span> <span class="n">HeatExchangerLumpedCapacitance</span><span class="p">,</span> <span class="n">HeatExchangerFlowPattern</span>
</pre></div>
</div>
</section>
<section id="setting-up-the-flowsheet">
<h2>Setting up the flowsheet<a class="headerlink" href="#setting-up-the-flowsheet" title="Permalink to this heading">¶</a></h2>
<p>Then, create the <code class="docutils literal notranslate"><span class="pre">ConcreteModel</span></code> foundation, attach the steady state
flowsheet, and declare the property parameter block that will used for
the shell and tube sides.</p>
<p>More information on this general workflow can be found here:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/stable/how_to_guides/workflow/general.html">https://idaes-pse.readthedocs.io/en/stable/how_to_guides/workflow/general.html</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties_shell</span> <span class="o">=</span> <span class="n">iapws95</span><span class="o">.</span><span class="n">Iapws95ParameterBlock</span><span class="p">()</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties_tube</span> <span class="o">=</span> <span class="n">GenericParameterBlock</span><span class="p">(</span><span class="o">**</span><span class="n">configuration</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, import and define the <code class="docutils literal notranslate"><span class="pre">HeatExchanger</span></code> unit, and add it to the
flowsheet. As mentioned above, we will designate the shell as the hot
side and the tube as the cold side. The <code class="docutils literal notranslate"><span class="pre">dynamic_heat_balance</span></code> is set
to <code class="docutils literal notranslate"><span class="pre">False</span></code> in this case, meaning heat holdup in the wall material is
not considered.</p>
<p>The unit is created below:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an instance of the heat exchanger unit, attaching it to the flowsheet</span>
<span class="c1"># Specify that the property packages to be used with the heat exchanger are the ones we created earlier.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span> <span class="o">=</span> <span class="n">HeatExchangerLumpedCapacitance</span><span class="p">(</span>
        <span class="n">hot_side_name</span><span class="o">=</span><span class="s2">&quot;shell&quot;</span><span class="p">,</span>
        <span class="n">cold_side_name</span><span class="o">=</span><span class="s2">&quot;tube&quot;</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties_shell</span><span class="p">},</span>
        <span class="n">tube</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties_tube</span><span class="p">},</span>
        <span class="n">flow_pattern</span><span class="o">=</span><span class="n">HeatExchangerFlowPattern</span><span class="o">.</span><span class="n">crossflow</span><span class="p">,</span>
        <span class="n">dynamic_heat_balance</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span>

<span class="c1"># Call the degrees_of_freedom function, get initial DOF</span>
<span class="n">DOF_initial</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The initial DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_initial</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">initial</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">12</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">DOF_initial</span> <span class="o">==</span> <span class="mi">12</span>
</pre></div>
</div>
</section>
<section id="fixing-input-specifications">
<h2>Fixing input specifications<a class="headerlink" href="#fixing-input-specifications" title="Permalink to this heading">¶</a></h2>
<p>In the following cell, we will use a function to calculate enthalpy,
then specify all of the necessary inputs for the heat exchanger, and
re-evaluate the degrees of freedom to ensure the problem is square
(i.e. DOF=0)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">htpx</span><span class="p">(</span><span class="mi">400</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="mi">101325</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">Pa</span><span class="p">)</span>  <span class="c1"># calculate IAPWS enthalpy</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">shell_inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># mol/s</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">shell_inlet</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span> <span class="c1"># Pa</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">shell_inlet</span><span class="o">.</span><span class="n">enth_mol</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="c1"># J/mol</span>

<span class="n">DOF_initial</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_initial</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">9</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span> <span class="c1"># mol/s</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span> <span class="c1"># Pa</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">380</span><span class="p">)</span> <span class="c1"># K</span>

<span class="n">DOF_final</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_final</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">4</span>
</pre></div>
</div>
<section id="fix-overall-heat-transfer-coefficient-htc-and-the-heat-transfer-area">
<h3>Fix overall heat transfer coefficient (HTC) and the heat transfer area<a class="headerlink" href="#fix-overall-heat-transfer-coefficient-htc-and-the-heat-transfer-area" title="Permalink to this heading">¶</a></h3>
<p>Unlike the other heat exchanger unit models which only require one heat
transfer coeffcient, the lump-capacitance model requires an overall heat
transfer coeffcient to be specified for the hot and cold sides. Below,
we fix the heat exchanger area and heat transfer coefficients, which
yields a fully defined problem with zero degrees of freedom that may be
initialized and solved:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># m2</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">ua_hot_side</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># W/m2/K</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">ua_cold_side</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># W/m2/K</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">crossflow_factor</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">DOF_final</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_final</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">DOF_final</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Now that the problem is square (zero degrees of freedom), we can
initialize and solve the full model:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the flowsheet, and set the output at INFO</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c1"># Solve the simulation using ipopt</span>
<span class="c1"># Note: If the degrees of freedom = 0, we have a square problem</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">()</span>
<span class="n">solve_status</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Display a readable report</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">hot_side</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Starting</span> <span class="n">initialization</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Dew</span> <span class="ow">and</span> <span class="n">bubble</span> <span class="n">point</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Equilibrium</span> <span class="n">temperature</span> <span class="n">initialization</span> <span class="n">completed</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">State</span> <span class="n">variable</span> <span class="n">initialization</span> <span class="n">completed</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Phase</span> <span class="n">equilibrium</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Property</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Starting</span> <span class="n">initialization</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Dew</span> <span class="ow">and</span> <span class="n">bubble</span> <span class="n">point</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Equilibrium</span> <span class="n">temperature</span> <span class="n">initialization</span> <span class="n">completed</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">State</span> <span class="n">variable</span> <span class="n">initialization</span> <span class="n">completed</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Phase</span> <span class="n">equilibrium</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Property</span> <span class="n">initialization</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">19</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">cold_side</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">20</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Completed</span><span class="p">,</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span>

<span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span>                                                   <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>              <span class="p">:</span> <span class="n">Value</span>   <span class="p">:</span> <span class="n">Units</span>                           <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
    <span class="n">Crossflow</span> <span class="n">Factor</span> <span class="p">:</span> <span class="mf">0.60000</span> <span class="p">:</span>                   <span class="n">dimensionless</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
             <span class="n">HX</span> <span class="n">Area</span> <span class="p">:</span>  <span class="mf">50.000</span> <span class="p">:</span>                      <span class="n">meter</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">HX</span> <span class="n">Coefficient</span> <span class="p">:</span>  <span class="mf">2000.0</span> <span class="p">:</span> <span class="n">kilogram</span> <span class="o">/</span> <span class="n">kelvin</span> <span class="o">/</span> <span class="n">second</span> <span class="o">**</span> <span class="mi">3</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
           <span class="n">Heat</span> <span class="n">Duty</span> <span class="p">:</span>  <span class="mf">73086.</span> <span class="p">:</span>                            <span class="n">watt</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">Expressions</span><span class="p">:</span>

    <span class="n">Key</span>             <span class="p">:</span> <span class="n">Value</span>      <span class="p">:</span> <span class="n">Units</span>
    <span class="n">Delta</span> <span class="n">T</span> <span class="n">Driving</span> <span class="p">:</span>     <span class="mf">1.2181</span> <span class="p">:</span> <span class="n">kelvin</span>
         <span class="n">Delta</span> <span class="n">T</span> <span class="n">In</span> <span class="p">:</span>     <span class="mf">17.621</span> <span class="p">:</span> <span class="n">kelvin</span>
        <span class="n">Delta</span> <span class="n">T</span> <span class="n">Out</span> <span class="p">:</span> <span class="mf">9.1977e-06</span> <span class="p">:</span> <span class="n">kelvin</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                                      <span class="n">Units</span>        <span class="n">shell</span> <span class="n">Inlet</span> <span class="n">shell</span> <span class="n">Outlet</span> <span class="n">tube</span> <span class="n">Inlet</span> <span class="n">tube</span> <span class="n">Outlet</span>
    <span class="n">Molar</span> <span class="n">Flow</span>                       <span class="n">mole</span> <span class="o">/</span> <span class="n">second</span>       <span class="mi">100</span>        <span class="mf">100.00</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">Mass</span> <span class="n">Flow</span>                    <span class="n">kilogram</span> <span class="o">/</span> <span class="n">second</span>    <span class="mf">1.8015</span>        <span class="mf">1.8015</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">T</span>                                       <span class="n">kelvin</span>    <span class="mf">400.00</span>        <span class="mf">380.00</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">P</span>                                       <span class="n">pascal</span>    <span class="mi">101325</span>    <span class="mf">1.0132e+05</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">Vapor</span> <span class="n">Fraction</span>                   <span class="n">dimensionless</span>    <span class="mf">1.0000</span>        <span class="mf">1.0000</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">Molar</span> <span class="n">Enthalpy</span>                    <span class="n">joule</span> <span class="o">/</span> <span class="n">mole</span>    <span class="mf">49187.</span>        <span class="mf">48456.</span>           <span class="o">-</span>           <span class="o">-</span>
    <span class="n">Total</span> <span class="n">Molar</span> <span class="n">Flowrate</span>             <span class="n">mole</span> <span class="o">/</span> <span class="n">second</span>         <span class="o">-</span>             <span class="o">-</span>         <span class="mi">250</span>      <span class="mf">250.00</span>
    <span class="n">Total</span> <span class="n">Mole</span> <span class="n">Fraction</span> <span class="n">benzene</span>      <span class="n">dimensionless</span>         <span class="o">-</span>             <span class="o">-</span>     <span class="mf">0.40000</span>     <span class="mf">0.40000</span>
    <span class="n">Total</span> <span class="n">Mole</span> <span class="n">Fraction</span> <span class="n">toluene</span>      <span class="n">dimensionless</span>         <span class="o">-</span>             <span class="o">-</span>     <span class="mf">0.60000</span>     <span class="mf">0.60000</span>
    <span class="n">Temperature</span>                             <span class="n">kelvin</span>         <span class="o">-</span>             <span class="o">-</span>         <span class="mi">380</span>      <span class="mf">382.38</span>
    <span class="n">Pressure</span>                                <span class="n">pascal</span>         <span class="o">-</span>             <span class="o">-</span>  <span class="mf">1.0132e+05</span>  <span class="mf">1.0132e+05</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">assert_optimal_termination</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="c1"># Check if termination condition is optimal</span>
<span class="n">assert_optimal_termination</span><span class="p">(</span><span class="n">solve_status</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="mf">380.0</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">heat_exchanger</span><span class="o">.</span><span class="n">tube</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="mf">382.38</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="heat_exchanger_1D.html" class="btn btn-neutral float-left" title="Heat Exchanger 1D Unit Model with Two Property Packages" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="heat_exchanger_NTU.html" class="btn btn-neutral float-right" title="Heat Exchanger NTU Unit Model with Aqueous MEA System" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>