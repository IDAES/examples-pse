<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial: Compressor Unit Model with Span-Wagner Property Package for supercritical CO2 &mdash; IDAES v2.0.0 Examples</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            IDAES Examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorials/index.html">IDAES Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IDAES Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial: Compressor Unit Model with Span-Wagner Property Package for supercritical CO2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/Examples/UnitModels/Operations/compressor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-compressor-unit-model-with-span-wagner-property-package-for-supercritical-co2">
<h1>Tutorial: Compressor Unit Model with Span-Wagner Property Package for supercritical CO2<a class="headerlink" href="#tutorial-compressor-unit-model-with-span-wagner-property-package-for-supercritical-co2" title="Permalink to this heading">¶</a></h1>
<img alt="../../../_images/compressor_2.svg" src="../../../_images/compressor_2.svg" /><section id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Demonstrate use of the compressor unit model in IDAES</p></li>
<li><p>Demonstarte use of the Span Wagner EOS for supercritical CO2 cycles</p></li>
<li><p>Demonstrate different simulation options available for the compressor
unit model</p></li>
</ul>
<p>In this tutorial, we will simulate the main compressor for an indirect
supercritical CO2 cycle using the Span-Wagner EOS as the property
package. The input specifications for this tutorial are from the NETL
report on indirect SCO2 cycles available
<a class="reference external" href="https://www.osti.gov/biblio/1490272">here</a>. In this example, we will
be compressing supercritical CO2 from 9.1 MPa to 34.5 MPa.</p>
<p>It is assumed that the compressor operates at steady state.</p>
<p>The inlet specifications are as follows:</p>
<ul class="simple">
<li><p>Flow Rate = 91067 mol/s</p></li>
<li><p>Pressure = 9.1107 MPa</p></li>
<li><p>Temperature = 308.15 K</p></li>
</ul>
<p>We will simulate 2 different cases, depending on the compressor
specifications fixed by the user:</p>
<p><strong>Case 1</strong>: In this case, we will fix the isentropic efficiency and the
pressure change across the compressor. * Pressure Change = 25.51 MPa *
Isentropic Efficiency = 0.85</p>
<p><strong>Case 2</strong>: In this case, we will fix the isentropic efficiency and the
pressure ratio instead of the pressure change across the compressor. *
Pressure Ratio = 3.8 * Isentropic Efficiency = 0.85</p>
<p>IDAES documentation:https://idaes-pse.readthedocs.io/en/stable/</p>
</section>
<section id="setting-up-the-problem-in-idaes">
<h2>Setting up the problem in IDAES<a class="headerlink" href="#setting-up-the-problem-in-idaes" title="Permalink to this heading">¶</a></h2>
<p>In the following cell, we will be importing the necessary components
from Pyomo and IDAES.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import objects from pyomo package</span>
<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">ConcreteModel</span><span class="p">,</span> <span class="n">SolverFactory</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">units</span>

<span class="c1"># Import the main FlowsheetBlock from IDAES. The flowsheet block will contain the unit model</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>

<span class="c1"># Import idaes logger to set output levels</span>
<span class="kn">import</span> <span class="nn">idaes.logger</span> <span class="k">as</span> <span class="nn">idaeslog</span>

<span class="c1"># Create the ConcreteModel and the FlowsheetBlock, and attach the flowsheet block to it.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># dynamic or ss flowsheet needs to be specified here</span>


<span class="c1"># Import the SWCO2 property package to create a properties block for the flowsheet</span>
<span class="kn">from</span> <span class="nn">idaes.models.properties.swco2</span> <span class="kn">import</span> <span class="n">SWCO2ParameterBlock</span><span class="p">,</span> <span class="n">StateVars</span><span class="p">,</span> <span class="n">htpx</span>

<span class="c1"># Add properties parameter block to the flowsheet with specifications</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">SWCO2ParameterBlock</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="case-1-fix-pressure-change-and-isentropic-efficiency">
<h2>Case 1: Fix pressure change and isentropic efficiency<a class="headerlink" href="#case-1-fix-pressure-change-and-isentropic-efficiency" title="Permalink to this heading">¶</a></h2>
<section id="add-compressor-unit-model">
<h3>Add Compressor Unit Model<a class="headerlink" href="#add-compressor-unit-model" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import compressor unit model from the model library</span>
<span class="kn">from</span> <span class="nn">idaes.models.unit_models.pressure_changer</span> <span class="kn">import</span> <span class="n">PressureChanger</span><span class="p">,</span><span class="n">ThermodynamicAssumption</span>

<span class="c1"># Create an instance of the compressor unit, attaching it to the flowsheet</span>
<span class="c1"># Specify that the property package to be used with the compressor is the one we created earlier.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span> <span class="o">=</span> <span class="n">PressureChanger</span><span class="p">(</span>
    <span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">property_package</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="p">,</span>
    <span class="n">compressor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">thermodynamic_assumption</span><span class="o">=</span><span class="n">ThermodynamicAssumption</span><span class="o">.</span><span class="n">isentropic</span><span class="p">)</span>

<span class="c1"># Import the degrees_of_freedom function from the idaes.core.util.model_statistics package</span>
<span class="c1"># DOF = Number of Model Variables - Number of Model Constraints</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.model_statistics</span> <span class="kn">import</span> <span class="n">degrees_of_freedom</span>

<span class="c1"># Call the degrees_of_freedom function, get intitial DOF</span>
<span class="n">DOF_initial</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The initial DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_initial</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">initial</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="fix-inlet-stream-conditions">
<h3>Fix Inlet Stream Conditions<a class="headerlink" href="#fix-inlet-stream-conditions" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the stream inlet conditions</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">91067</span><span class="p">)</span> <span class="c1"># mol/s</span>

<span class="c1"># Use htpx method to obtain the molar enthalpy of inlet stream at the given temperature and pressure conditions</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">enth_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">value</span><span class="p">(</span><span class="n">htpx</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">308.15</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">9.1107e+06</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">Pa</span><span class="p">)))</span> <span class="c1"># T in K, P in Pa</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">9.1107e+06</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fix-pressure-change-and-isentropic-efficiency">
<h3>Fix Pressure Change and Isentropic Efficiency<a class="headerlink" href="#fix-pressure-change-and-isentropic-efficiency" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix compressor conditions</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">2.5510e+07</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">efficiency_isentropic</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>

<span class="c1"># Call the degrees_of_freedom function, get final DOF</span>
<span class="n">DOF_final</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The final DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_final</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">final</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the flowsheet, and set the output at INFO level</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">46</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span>
</pre></div>
</div>
</section>
<section id="solve-model">
<h3>Solve Model<a class="headerlink" href="#solve-model" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the simulation using ipopt</span>
<span class="c1"># Note: If the degrees of freedom = 0, we have a square problem</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;ipopt&#39;</span><span class="p">)</span>
<span class="n">solve_status</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2:

<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:       18
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        8

Total number of variables............................:        9
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        4
                     variables with only upper bounds:        0
Total number of equality constraints.................:        9
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.12e-11 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0

Number of Iterations....: 0

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   3.1150193535722792e-11    3.1150193535722792e-11
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   3.1150193535722792e-11    3.1150193535722792e-11


Number of objective function evaluations             = 1
Number of objective gradient evaluations             = 1
Number of equality constraint evaluations            = 1
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      0.002
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
</pre>
</section>
<section id="view-results">
<h3>View Results<a class="headerlink" href="#view-results" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display Outlet Pressure</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_pressure_outlet_ref</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="n">ReferenceTo</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
    <span class="n">Key</span> <span class="p">:</span> <span class="n">Lower</span>                  <span class="p">:</span> <span class="n">Value</span>      <span class="p">:</span> <span class="n">Upper</span>       <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Stale</span> <span class="p">:</span> <span class="n">Domain</span>
    <span class="mf">0.0</span> <span class="p">:</span> <span class="mf">1.0000000000000002e-06</span> <span class="p">:</span> <span class="mf">34620700.0</span> <span class="p">:</span> <span class="mf">500000000.0</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="n">PositiveReals</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display a readable report</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">compr_case_1</span>                                                     <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>                   <span class="p">:</span> <span class="n">Value</span>      <span class="p">:</span> <span class="n">Units</span>         <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
    <span class="n">Isentropic</span> <span class="n">Efficiency</span> <span class="p">:</span>    <span class="mf">0.85000</span> <span class="p">:</span> <span class="n">dimensionless</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">Mechanical</span> <span class="n">Work</span> <span class="p">:</span> <span class="mf">1.5934e+08</span> <span class="p">:</span>          <span class="n">watt</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">Pressure</span> <span class="n">Change</span> <span class="p">:</span> <span class="mf">2.5510e+07</span> <span class="p">:</span>        <span class="n">pascal</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
           <span class="n">Pressure</span> <span class="n">Ratio</span> <span class="p">:</span>     <span class="mf">3.8000</span> <span class="p">:</span> <span class="n">dimensionless</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                         <span class="n">Units</span>           <span class="n">Inlet</span>     <span class="n">Outlet</span>
    <span class="n">Molar</span> <span class="n">Flow</span>          <span class="n">mole</span> <span class="o">/</span> <span class="n">second</span>     <span class="mf">91067.</span>     <span class="mf">91067.</span>
    <span class="n">Mass</span> <span class="n">Flow</span>       <span class="n">kilogram</span> <span class="o">/</span> <span class="n">second</span>     <span class="mf">4007.8</span>     <span class="mf">4007.8</span>
    <span class="n">T</span>                          <span class="n">kelvin</span>     <span class="mf">308.15</span>     <span class="mf">348.81</span>
    <span class="n">P</span>                          <span class="n">pascal</span> <span class="mf">9.1107e+06</span> <span class="mf">3.4621e+07</span>
    <span class="n">Vapor</span> <span class="n">Fraction</span>      <span class="n">dimensionless</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>
    <span class="n">Molar</span> <span class="n">Enthalpy</span>       <span class="n">joule</span> <span class="o">/</span> <span class="n">mole</span>    <span class="o">-</span><span class="mf">9215.6</span>    <span class="o">-</span><span class="mf">7465.9</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
</section>
</section>
<section id="case-2-fix-pressure-ratio-and-isentropic-efficiency">
<h2>Case 2: Fix pressure ratio and isentropic efficiency<a class="headerlink" href="#case-2-fix-pressure-ratio-and-isentropic-efficiency" title="Permalink to this heading">¶</a></h2>
<section id="add-compressor-unit">
<h3>Add Compressor Unit<a class="headerlink" href="#add-compressor-unit" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an instance of another compressor unit, attaching it to the flowsheet</span>
<span class="c1"># Specify that the property package to be used with the turbine is the one we created earlier.</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span> <span class="o">=</span> <span class="n">PressureChanger</span><span class="p">(</span>
    <span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">property_package</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="p">,</span>
    <span class="n">compressor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">thermodynamic_assumption</span><span class="o">=</span><span class="n">ThermodynamicAssumption</span><span class="o">.</span><span class="n">isentropic</span><span class="p">)</span>

<span class="c1"># Call the degrees_of_freedom function, get intitial DOF</span>
<span class="n">DOF_initial</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The initial DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_initial</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">initial</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Fix Inlet Stream Conditions<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the stream inlet conditions</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">91067</span><span class="p">)</span> <span class="c1"># converting to mol/s as unit basis is mol/s</span>

<span class="c1"># Use htpx method to obtain the molar enthalpy of inlet stream at the given temperature and pressure conditions</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">enth_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">value</span><span class="p">(</span><span class="n">htpx</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">308.15</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">9.1107e+06</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">Pa</span><span class="p">)))</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">9.1107e+06</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fix-compressor-pressure-ratio-and-isentropic-efficiency">
<h3>Fix Compressor Pressure Ratio and Isentropic Efficiency<a class="headerlink" href="#fix-compressor-pressure-ratio-and-isentropic-efficiency" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix compressor pressure ratio</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">ratioP</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">3.8</span><span class="p">)</span>

<span class="c1"># Fix compressor efficiency</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">efficiency_isentropic</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>

<span class="c1"># Call the degrees_of_freedom function, get final DOF</span>
<span class="n">DOF_final</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The final DOF is </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DOF_final</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">final</span> <span class="n">DOF</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>Initialization<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the flowsheet, and set the output at INFO level</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">47</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Solve Model<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the simulation using ipopt</span>
<span class="c1"># Note: If the degrees of freedom = 0, we have a square problem</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;ipopt&#39;</span><span class="p">)</span>
<span class="n">solve_status</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2:

<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:       18
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        8

Total number of variables............................:        9
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        4
                     variables with only upper bounds:        0
Total number of equality constraints.................:        9
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.19e-07 0.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0

Number of Iterations....: 0

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   1.3090284027230638e-10    1.1920928955078125e-07
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.3090284027230638e-10    1.1920928955078125e-07


Number of objective function evaluations             = 1
Number of objective gradient evaluations             = 1
Number of equality constraint evaluations            = 1
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      0.002
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
</pre>
</section>
<section id="id4">
<h3>View Results<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display compressor pressure increase</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">outlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="p">:</span> <span class="n">Pressure</span>
    <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Units</span><span class="o">=</span><span class="n">Pa</span>
    <span class="n">Key</span>  <span class="p">:</span> <span class="n">Lower</span>                  <span class="p">:</span> <span class="n">Value</span>      <span class="p">:</span> <span class="n">Upper</span>       <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Stale</span> <span class="p">:</span> <span class="n">Domain</span>
    <span class="kc">None</span> <span class="p">:</span> <span class="mf">1.0000000000000002e-06</span> <span class="p">:</span> <span class="mf">34620660.0</span> <span class="p">:</span> <span class="mf">500000000.0</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="n">PositiveReals</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display a readable report</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">compr_case_2</span>                                                     <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>                   <span class="p">:</span> <span class="n">Value</span>      <span class="p">:</span> <span class="n">Units</span>         <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
    <span class="n">Isentropic</span> <span class="n">Efficiency</span> <span class="p">:</span>    <span class="mf">0.85000</span> <span class="p">:</span> <span class="n">dimensionless</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">Mechanical</span> <span class="n">Work</span> <span class="p">:</span> <span class="mf">1.5934e+08</span> <span class="p">:</span>          <span class="n">watt</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">Pressure</span> <span class="n">Change</span> <span class="p">:</span> <span class="mf">2.5510e+07</span> <span class="p">:</span>        <span class="n">pascal</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
           <span class="n">Pressure</span> <span class="n">Ratio</span> <span class="p">:</span>     <span class="mf">3.8000</span> <span class="p">:</span> <span class="n">dimensionless</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                         <span class="n">Units</span>           <span class="n">Inlet</span>     <span class="n">Outlet</span>
    <span class="n">Molar</span> <span class="n">Flow</span>          <span class="n">mole</span> <span class="o">/</span> <span class="n">second</span>     <span class="mf">91067.</span>     <span class="mf">91067.</span>
    <span class="n">Mass</span> <span class="n">Flow</span>       <span class="n">kilogram</span> <span class="o">/</span> <span class="n">second</span>     <span class="mf">4007.8</span>     <span class="mf">4007.8</span>
    <span class="n">T</span>                          <span class="n">kelvin</span>     <span class="mf">308.15</span>     <span class="mf">348.81</span>
    <span class="n">P</span>                          <span class="n">pascal</span> <span class="mf">9.1107e+06</span> <span class="mf">3.4621e+07</span>
    <span class="n">Vapor</span> <span class="n">Fraction</span>      <span class="n">dimensionless</span>     <span class="mf">0.0000</span>     <span class="mf">0.0000</span>
    <span class="n">Molar</span> <span class="n">Enthalpy</span>       <span class="n">joule</span> <span class="o">/</span> <span class="n">mole</span>    <span class="o">-</span><span class="mf">9215.6</span>    <span class="o">-</span><span class="mf">7465.9</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>