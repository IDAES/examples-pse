<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Design Flowsheet for NGCC + SOEC with Steam Integration &mdash; IDAES v2.0.0a2 Examples</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> IDAES Examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorials/index.html">IDAES Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IDAES Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Design Flowsheet for NGCC + SOEC with Steam Integration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/Examples/Flowsheets/ngcc/ngcc_soec.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="design-flowsheet-for-ngcc-soec-with-steam-integration">
<h1>Design Flowsheet for NGCC + SOEC with Steam Integration<a class="headerlink" href="#design-flowsheet-for-ngcc-soec-with-steam-integration" title="Permalink to this heading">¶</a></h1>
<p>This flowsheet example provides an off-design model for integration of
an SOEC for hydrogen production with an NGCC. The NGCC nominally
produces 650 MW net, and includeds 97% CO2 capture. A detailed SOEC unit
model is used here.</p>
<section id="import-required-modules">
<h2>Import Required Modules<a class="headerlink" href="#import-required-modules" title="Permalink to this heading">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="kn">import</span> <span class="nn">pyomo.environ</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">from</span> <span class="nn">idaes.core.solvers</span> <span class="kn">import</span> <span class="n">use_idaes_solver_configuration_defaults</span>
<span class="kn">import</span> <span class="nn">idaes</span>
<span class="kn">import</span> <span class="nn">idaes.core.util.scaling</span> <span class="k">as</span> <span class="nn">iscale</span>
<span class="kn">import</span> <span class="nn">idaes.core.util</span> <span class="k">as</span> <span class="nn">iutil</span>
<span class="kn">import</span> <span class="nn">soec_flowsheet_costing</span>
<span class="kn">import</span> <span class="nn">ngcc_soec</span>
</pre></div>
</div>
</section>
<section id="make-output-directories">
<h2>Make Output Directories<a class="headerlink" href="#make-output-directories" title="Permalink to this heading">¶</a></h2>
<p>This notebook can produce a large number of output files. To make it
easier to manage, some subdirectories are used to orginize output. This
ensures that the drectories exist.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_directory</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a directory if it doesn&#39;t exist&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="n">make_directory</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">make_directory</span><span class="p">(</span><span class="s2">&quot;data_pfds&quot;</span><span class="p">)</span>
<span class="n">make_directory</span><span class="p">(</span><span class="s2">&quot;data_tabulated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="set-global-solver-options">
<h2>Set Global Solver Options<a class="headerlink" href="#set-global-solver-options" title="Permalink to this heading">¶</a></h2>
<p>Setting global solver options applies them to any solver created
subsequently, including the ones used for initialization. The user
scaling option disables Ipopt’s automatic scaling and allows it to use
user provided variable scaling.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_idaes_solver_configuration_defaults</span><span class="p">()</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">nlp_scaling_method</span> <span class="o">=</span> <span class="s2">&quot;user-scaling&quot;</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">linear_solver</span> <span class="o">=</span> <span class="s2">&quot;ma57&quot;</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">OF_ma57_automatic_scaling</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">ma57_pivtol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">ma57_pivtolmax</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">idaes</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ipopt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">SolverFactory</span><span class="p">(</span><span class="s2">&quot;ipopt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-and-initialize-the-ngcc-soec-model">
<h2>Create and Initialize the NGCC + SOEC Model<a class="headerlink" href="#create-and-initialize-the-ngcc-soec-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">ConcreteModel</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">ngcc_soec</span><span class="o">.</span><span class="n">NgccSoecFlowsheet</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dynamic&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
<span class="n">iscale</span><span class="o">.</span><span class="n">calculate_scaling_factors</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span>
    <span class="n">load_from</span><span class="o">=</span><span class="s2">&quot;ngcc_soec_init.json.gz&quot;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="o">=</span><span class="s2">&quot;ngcc_soec_init.json.gz&quot;</span>
<span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">soec_flowsheet_costing</span><span class="o">.</span><span class="n">get_solo_soec_capital_costing</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">2022-06-09 18:06:37 [INFO] idaes.init.fs: NGCC/SOEC design load initial from ngcc_soec_init.json.gz
Ipopt 3.13.2: nlp_scaling_method=user-scaling
tol=1e-06
linear_solver=ma57
ma57_pivtol=1e-05
ma57_pivtolmax=0.1
max_iter=200
option_file_name=/tmp/tmpof2610aj_ipopt.opt

Using option file &quot;/tmp/tmpof2610aj_ipopt.opt&quot;.


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    19286
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    14667

Total number of variables............................:     4373
                     variables with only lower bounds:      372
                variables with lower and upper bounds:     2355
                     variables with only upper bounds:       70
Total number of equality constraints.................:     4373
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.50e+01 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (387510)
Reallocating memory for MA57: lfact (411602)
   1  0.0000000e+00 2.56e+00 3.14e+06  -1.0 6.78e+04    -  9.81e-01 9.90e-01h  1
   2  0.0000000e+00 1.67e+00 9.98e+05  -1.0 5.36e+04    -  8.51e-01 9.91e-01h  1
   3  0.0000000e+00 1.01e-01 2.96e+04  -1.0 1.33e+04    -  9.83e-01 1.00e+00h  1
   4  0.0000000e+00 3.83e-04 9.01e+03  -1.0 6.38e+02    -  9.90e-01 1.00e+00h  1
   5  0.0000000e+00 1.49e-05 8.82e+01  -1.0 2.78e+01    -  9.90e-01 1.00e+00h  1
   6  0.0000000e+00 6.08e-07 2.17e+03  -2.5 1.16e+00    -  9.98e-01 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   6.0799920728604739e-07    6.0799920728604739e-07
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   6.0799920728604739e-07    6.0799920728604739e-07


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      1.015
Total CPU secs in NLP function evaluations           =      3.312

EXIT: Optimal Solution Found.
WARNING: DEPRECATED: The get_costing method is being deprecated in favor of
    the new FlowsheetCostingBlock tools.  (deprecated in TBD) (called from
    /tmp/ipykernel_3379/132183951.py:9)
WARNING: DEPRECATED: The get_costing method is being deprecated in favor of
    the new FlowsheetCostingBlock tools.  (deprecated in TBD) (called from
    /tmp/ipykernel_3379/132183951.py:9)
WARNING: DEPRECATED: The get_costing method is being deprecated in favor of
    the new FlowsheetCostingBlock tools.  (deprecated in TBD) (called from
    /tmp/ipykernel_3379/132183951.py:9)
WARNING: DEPRECATED: The get_costing method is being deprecated in favor of
    the new FlowsheetCostingBlock tools.  (deprecated in TBD) (called from
    /tmp/ipykernel_3379/132183951.py:9)
fs.soec.soec_module.costing.total_plant_cost
fs.soec.cmp01.costing.total_plant_cost
fs.soec.sweep_hx.costing.total_plant_cost
fs.soec.feed_hx01.costing.total_plant_cost
fs.soec.sweep_compressor.costing.total_plant_cost
Ipopt 3.13.2: nlp_scaling_method=user-scaling
tol=1e-06
linear_solver=ma57
ma57_pivtol=1e-05
ma57_pivtolmax=0.1
max_iter=200
option_file_name=/tmp/tmpngwoefqy_ipopt.opt

Using option file &quot;/tmp/tmpngwoefqy_ipopt.opt&quot;.


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    19337
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    14689

Total number of variables............................:     4390
                     variables with only lower bounds:      381
                variables with lower and upper bounds:     2362
                     variables with only upper bounds:       70
Total number of equality constraints.................:     4390
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.54e+06 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
Reallocating memory for MA57: lfact (389703)
Reallocating memory for MA57: lfact (414708)
   1  0.0000000e+00 5.90e+05 1.42e+10  -1.0 3.38e+06    -  2.92e-03 9.90e-01h  1
   2  0.0000000e+00 5.38e+03 4.52e+09  -1.0 6.31e+05    -  8.03e-01 9.91e-01h  1
   3  0.0000000e+00 7.92e+00 1.35e+08  -1.0 1.33e+04    -  9.54e-01 1.00e+00h  1
   4  0.0000000e+00 1.74e-02 1.09e+05  -1.0 6.38e+02    -  9.90e-01 1.00e+00h  1
   5  0.0000000e+00 3.77e-05 9.33e+01  -1.0 2.86e+01    -  9.90e-01 1.00e+00h  1
   6  0.0000000e+00 6.08e-07 9.23e-01  -1.0 1.20e+00    -  9.90e-01 1.00e+00h  1

Number of Iterations....: 6

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   6.0800438811403623e-07    6.0800438811403623e-07
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   6.0800438811403623e-07    6.0800438811403623e-07


Number of objective function evaluations             = 7
Number of objective gradient evaluations             = 7
Number of equality constraint evaluations            = 7
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 7
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 6
Total CPU secs in IPOPT (w/o function evaluations)   =      0.911
Total CPU secs in NLP function evaluations           =      3.182

EXIT: Optimal Solution Found.</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display_pfd</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Gas Turbine Section</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">SVG</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">gt</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">HRSG Section</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">SVG</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">hrsg</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Steam Turbine Section</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">SVG</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">SOEC Section</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">SVG</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">()))</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">gt</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;data_pfds/gt_soec_base.svg&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">hrsg</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;data_pfds/hrsg_soec_base.svg&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;data_pfds/st_soec_base.svg&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">write_pfd</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;data_pfds/soec_soec_base.svg&quot;</span><span class="p">)</span>

<span class="n">display_pfd</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Gas</span> <span class="n">Turbine</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_9_1.svg" src="../../../_images/output_9_1.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HRSG</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_9_3.svg" src="../../../_images/output_9_3.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Steam</span> <span class="n">Turbine</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_9_5.svg" src="../../../_images/output_9_5.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SOEC</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_9_7.svg" src="../../../_images/output_9_7.svg" /><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">net_power_mw</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">steam_turbine</span><span class="o">.</span><span class="n">throttle_valve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net_power_mw</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="n">Units</span><span class="o">=</span><span class="n">MW</span>
    <span class="n">Key</span> <span class="p">:</span> <span class="n">Lower</span> <span class="p">:</span> <span class="n">Value</span>             <span class="p">:</span> <span class="n">Upper</span> <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Stale</span> <span class="p">:</span> <span class="n">Domain</span>
    <span class="mf">0.0</span> <span class="p">:</span>  <span class="kc">None</span> <span class="p">:</span> <span class="mf">622.7120360634216</span> <span class="p">:</span>  <span class="kc">None</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span>  <span class="n">Reals</span>
<span class="n">deltaP</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span> <span class="n">ReferenceTo</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">steam_turbine</span><span class="o">.</span><span class="n">throttle_valve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">deltaP</span>
    <span class="n">Key</span> <span class="p">:</span> <span class="n">Lower</span> <span class="p">:</span> <span class="n">Value</span>              <span class="p">:</span> <span class="n">Upper</span> <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Stale</span> <span class="p">:</span> <span class="n">Domain</span>
    <span class="mf">0.0</span> <span class="p">:</span>  <span class="kc">None</span> <span class="p">:</span> <span class="o">-</span><span class="mf">3551616.622353147</span> <span class="p">:</span>  <span class="kc">None</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">:</span>  <span class="n">Reals</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decision_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">make_decision_var</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">):</span>
    <span class="n">v</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
    <span class="n">decision_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="c1"># Add constraints for optimization</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">steam_turbine</span><span class="o">.</span><span class="n">throttle_valve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="o">-</span><span class="mf">1e5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="s2">&quot;O2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">1030</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mi">1030</span><span class="p">)</span>

<span class="nd">@m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">makeup_water_constraint</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">water_pump</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_hx01</span><span class="o">.</span><span class="n">tube_inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="c1"># make sure the delta T on the hydrogen side is 40K or less (it&#39;s</span>
<span class="c1"># squared so one constraint covers both positive and negative delta T)</span>
<span class="nd">@m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delta_T_h_constraint</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span>
    <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="mi">16</span>

<span class="c1"># make sure the delta T on the oxygen side is 40K or less</span>
<span class="nd">@m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delta_T_o_constraint</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span>
    <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="mi">16</span>

<span class="c1"># make sure the oxygen inlet and hydrogen outlet are 40K or less apart</span>
<span class="nd">@m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delta_T_1_constraint</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span>
    <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="mi">16</span>

<span class="c1"># make sure the hydrogen inlet and oxygen outlet are 40K or less apart</span>
<span class="nd">@m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delta_T_2_constraint</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="o">-</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">mixed_state</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span>
    <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="mi">16</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">water_pump</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;out&quot;</span><span class="p">],</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_recycle_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;out&quot;</span><span class="p">],</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">water_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;outlet1&quot;</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_compressor</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">soec_module</span><span class="o">.</span><span class="n">potential_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">1020</span><span class="p">)</span>
<span class="n">make_decision_var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">1020</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">pyo</span><span class="o">.</span><span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">net_power</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">total_electric_power</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2: nlp_scaling_method=user-scaling
tol=1e-06
linear_solver=ma57
ma57_pivtol=1e-05
ma57_pivtolmax=0.1
max_iter=200
option_file_name=/tmp/tmp4521uw3l_ipopt.opt

Using option file &quot;/tmp/tmp4521uw3l_ipopt.opt&quot;.


<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma57.

Number of nonzeros in equality constraint Jacobian...:    19368
Number of nonzeros in inequality constraint Jacobian.:        8
Number of nonzeros in Lagrangian Hessian.............:    14735

Reallocating memory for MA57: lfact (347776)
Total number of variables............................:     4398
                     variables with only lower bounds:      381
                variables with lower and upper bounds:     2369
                     variables with only upper bounds:       71
Total number of equality constraints.................:     4391
Total number of inequality constraints...............:        4
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        4

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  6.5286053e+01 1.79e+02 4.79e+02  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  6.5066939e+01 1.29e+02 3.60e+03  -1.0 7.21e+03    -  7.24e-01 2.80e-01h  1
   2  6.3981667e+01 4.35e+00 6.68e+03  -1.0 2.14e+03    -  3.00e-01 9.90e-01h  1
   3  6.3899876e+01 4.49e+00 4.64e+03  -1.0 1.87e+03    -  8.70e-01 2.92e-01h  1
   4  6.3889634e+01 5.66e-01 2.75e+02  -1.0 4.48e+03    -  7.77e-01 9.41e-01h  1
   5  6.3407224e+01 1.27e+00 2.80e+03  -1.0 1.51e+04    -  5.91e-01 5.00e-01f  2
   6  6.1823933e+01 6.56e+00 1.19e+04  -1.0 3.47e+04    -  6.71e-01 5.00e-01f  2
   7  6.0861476e+01 8.13e+00 6.65e+04  -1.0 7.94e+04    -  6.33e-01 1.25e-01h  4
   8  5.9728351e+01 1.21e+01 1.39e+05  -1.0 1.33e+05    -  7.60e-01 8.29e-02f  4
   9  5.9343446e+01 1.37e+01 2.11e+05  -1.0 3.19e+05    -  6.94e-01 1.92e-02h  6
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10  5.9242043e+01 1.39e+01 3.06e+05  -1.0 5.93e+05    -  9.42e-01 4.37e-03h  8
  11  5.9158074e+01 1.43e+01 3.92e+05  -1.0 9.46e+05    -  9.90e-01 3.02e-03h  8
  12  4.8072188e+01 6.31e+03 2.44e+05  -1.0 7.41e+05    -  9.99e-01 4.77e-01f  1
  13  4.7986343e+01 1.27e+03 3.33e+04  -1.0 1.15e+05    -  9.80e-01 8.99e-01h  1
  14  5.0323197e+01 1.32e+01 6.08e+04  -1.0 2.95e+04    -  7.64e-01 1.00e+00h  1
  15  4.9713744e+01 5.69e-01 1.59e+00  -1.0 5.03e+03    -  1.00e+00 1.00e+00h  1
  16  4.8089174e+01 1.75e+01 1.97e+05  -1.7 4.03e+04    -  4.95e-01 7.41e-01f  1
  17  4.8460720e+01 3.38e-03 1.48e+00  -1.7 4.73e+02    -  1.00e+00 1.00e+00h  1
  18  4.8209659e+01 4.27e-01 3.08e+04  -3.8 5.58e+03    -  9.77e-01 8.22e-01h  1
  19  4.8257014e+01 3.84e-05 2.32e+03  -3.8 9.50e-01  -4.0 4.96e-01 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20  4.8247833e+01 2.88e-03 1.76e+03  -3.8 1.27e+04    -  2.41e-01 1.88e-02f  1
  21  4.8235907e+01 2.00e-03 1.62e+01  -3.8 5.89e+02    -  1.00e+00 3.13e-01f  1
  22  4.8231343e+01 2.42e-03 1.72e+01  -3.8 4.05e+02    -  9.57e-01 3.98e-01f  1
  23  4.8225824e+01 6.28e-04 2.31e-01  -3.8 1.84e+02    -  1.00e+00 1.00e+00h  1
  24  4.8227461e+01 3.09e-06 5.26e-03  -3.8 7.01e+00    -  1.00e+00 1.00e+00h  1
  25  4.8227539e+01 1.93e-07 3.30e-04  -3.8 5.16e-01    -  1.00e+00 1.00e+00h  1
  26  4.8226355e+01 6.49e-06 8.58e-03  -5.7 2.20e+01    -  1.00e+00 1.00e+00f  1
  27  4.8226547e+01 3.77e-07 6.41e-04  -5.7 8.95e-01    -  1.00e+00 1.00e+00h  1
  28  4.8226557e+01 1.88e-08 3.18e-05  -5.7 4.04e-02    -  1.00e+00 1.00e+00h  1
  29  4.8226558e+01 8.80e-10 1.49e-06  -5.7 1.86e-03    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30  4.8226544e+01 5.75e-08 1.01e-04  -7.0 2.59e-01    -  1.00e+00 1.00e+00h  1
  31  4.8226546e+01 4.45e-09 7.56e-06  -7.0 1.06e-02    -  1.00e+00 1.00e+00h  1
  32  4.8226546e+01 2.22e-10 3.76e-07  -7.0 4.78e-04    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 32

                                   (scaled)                 (unscaled)
Objective...............:   4.8226545902875309e+01    4.8226545902875309e+01
Dual infeasibility......:   3.7606556390108969e-07    2.4697932587969262e-09
Constraint violation....:   2.2178811565076728e-10    2.2178811565076728e-10
Complementarity.........:   9.0909096311388913e-08    9.0909096311388913e-08
Overall NLP error.......:   3.7606556390108969e-07    9.0909096311388913e-08


Number of objective function evaluations             = 78
Number of objective gradient evaluations             = 33
Number of equality constraint evaluations            = 78
Number of inequality constraint evaluations          = 78
Number of equality constraint Jacobian evaluations   = 33
Number of inequality constraint Jacobian evaluations = 33
Number of Lagrangian Hessian evaluations             = 32
Total CPU secs in IPOPT (w/o function evaluations)   =      2.619
Total CPU secs in NLP function evaluations           =     32.957

EXIT: Optimal Solution Found.</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_pfd</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Gas</span> <span class="n">Turbine</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_13_1.svg" src="../../../_images/output_13_1.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HRSG</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_13_3.svg" src="../../../_images/output_13_3.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Steam</span> <span class="n">Turbine</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_13_5.svg" src="../../../_images/output_13_5.svg" /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SOEC</span> <span class="n">Section</span>
</pre></div>
</div>
<img alt="../../../_images/output_13_7.svg" src="../../../_images/output_13_7.svg" /><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall net power: </span><span class="si">{</span><span class="o">-</span><span class="n">pyo</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">decision_vars</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pyo</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overall</span> <span class="n">net</span> <span class="n">power</span><span class="p">:</span> <span class="o">-</span><span class="mf">48.2265459028753</span> <span class="n">MW</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_recycle_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="n">out</span><span class="p">]</span> <span class="mf">0.97</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_recycle_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="n">out</span><span class="p">]</span> <span class="mf">0.6142554936030024</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">water_split</span><span class="o">.</span><span class="n">split_fraction</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="n">outlet1</span><span class="p">]</span> <span class="mf">0.5014039272374016</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_compressor</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">flow_mol</span> <span class="mf">3863.3669749528385</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">soec_module</span><span class="o">.</span><span class="n">solid_oxide_cell</span><span class="o">.</span><span class="n">potential</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="mf">1.311689279712575</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">feed_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="mf">990.0000100581312</span>
<span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">sweep_heater</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span> <span class="mf">990.00001283722</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_samples</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">run_samples</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="n">gt_powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">480.</span><span class="p">,</span> <span class="mf">300.</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="mf">480.</span> <span class="o">-</span> <span class="mf">300.</span><span class="p">)</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">hp_powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="mf">5.</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">/</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">cap_specific_reboiler_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">2.4e6</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">cap_fraction</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.97</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">tags_output</span><span class="o">.</span><span class="n">table_heading</span><span class="p">())</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">gp</span> <span class="ow">in</span> <span class="n">gt_powers</span><span class="p">:</span>
        <span class="n">gpstr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">gp</span><span class="p">))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ngcc</span><span class="o">.</span><span class="n">gt</span><span class="o">.</span><span class="n">gt_power</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="o">-</span><span class="n">gp</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
        <span class="n">save_to_last</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;data/ngcc_soec_</span><span class="si">{</span><span class="n">gpstr</span><span class="si">}</span><span class="s2">_5000.json.gz&quot;</span>
        <span class="k">for</span> <span class="n">hp</span> <span class="ow">in</span> <span class="n">hp_powers</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">hydrogen_product_rate</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">hp</span><span class="p">)</span>
            <span class="n">hpstr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">hp</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
            <span class="n">save_to</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;data/ngcc_soec_</span><span class="si">{</span><span class="n">gpstr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">hpstr</span><span class="si">}</span><span class="s2">.json.gz&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">save_to</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_to</span><span class="p">):</span>
                <span class="n">iutil</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">save_to</span><span class="p">,</span> <span class="n">wts</span><span class="o">=</span><span class="n">iutil</span><span class="o">.</span><span class="n">StoreSpec</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pyo</span><span class="o">.</span><span class="n">check_optimal_termination</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="n">iutil</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">save_to</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall net power: </span><span class="si">{</span><span class="o">-</span><span class="n">pyo</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">decision_vars</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pyo</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">soec</span><span class="o">.</span><span class="n">water_pump</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">tags_output</span><span class="o">.</span><span class="n">table_row</span><span class="p">(</span><span class="n">numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># go to the closes part of the start of the next series.</span>
        <span class="n">iutil</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">save_to_last</span><span class="p">,</span> <span class="n">wts</span><span class="o">=</span><span class="n">iutil</span><span class="o">.</span><span class="n">StoreSpec</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>