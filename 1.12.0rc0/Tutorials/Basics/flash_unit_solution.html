<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flash Unit Model &mdash; IDAES v1.13.0dev0 Examples</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> IDAES Examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../Examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">IDAES Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IDAES Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Flash Unit Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Tutorials/Basics/flash_unit_solution.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flash-unit-model">
<h1>Flash Unit Model<a class="headerlink" href="#flash-unit-model" title="Permalink to this headline">¶</a></h1>
<p>In this module, we will familiarize ourselves with the IDAES framework
by creating and working with a flowsheet that contains a single flash
tank. The flash tank will be used to perform separation of Benzene and
Toluene. The inlet specifications for this flash tank are:</p>
<p>Inlet Specifications: * Mole fraction (Benzene) = 0.5 * Mole fraction
(Toluene) = 0.5 * Pressure = 101325 Pa * Temperature = 368 K</p>
<p>We will complete the following tasks: * Create the model and the IDAES
Flowsheet object * Import the appropriate property packages * Create
the flash unit and set the operating conditions * Initialize the model
and simulate the system * Demonstrate analyses on this model through
some examples and exercises</p>
<section id="key-links-to-documentation">
<h2>Key links to documentation<a class="headerlink" href="#key-links-to-documentation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Main IDAES online documentation page:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/stable/">https://idaes-pse.readthedocs.io/en/stable/</a></p></li>
</ul>
</section>
<section id="create-the-model-and-the-idaes-flowsheet">
<h2>Create the Model and the IDAES Flowsheet<a class="headerlink" href="#create-the-model-and-the-idaes-flowsheet" title="Permalink to this headline">¶</a></h2>
<p>In the next cell, we will perform the necessary imports to get us
started. From <code class="docutils literal notranslate"><span class="pre">pyomo.environ</span></code> (a standard import for the Pyomo
package), we are importing <code class="docutils literal notranslate"><span class="pre">ConcreteModel</span></code> (to create the Pyomo model
that will contain the IDAES flowsheet) and <code class="docutils literal notranslate"><span class="pre">SolverFactory</span></code> (to create
the object we will use to solve the equations). We will also import
<code class="docutils literal notranslate"><span class="pre">Constraint</span></code> as we will be adding a constraint to the model later in
the module. Lastly, we also import <code class="docutils literal notranslate"><span class="pre">value</span></code> from Pyomo. This is a
function that can be used to return the current numerical value for
variables and parameters in the model. These are all part of Pyomo.</p>
<p>We will also import the main <code class="docutils literal notranslate"><span class="pre">FlowsheetBlock</span></code> from IDAES. The
flowsheet block will contain our unit model.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the cell below to perform the imports. Let a
workshop organizer know if you see any errors.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="n">ConcreteModel</span><span class="p">,</span> <span class="n">SolverFactory</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">value</span>
<span class="kn">from</span> <span class="nn">idaes.core</span> <span class="kn">import</span> <span class="n">FlowsheetBlock</span>

<span class="c1"># Import idaes logger to set output levels</span>
<span class="kn">import</span> <span class="nn">idaes.logger</span> <span class="k">as</span> <span class="nn">idaeslog</span>
</pre></div>
</div>
<p>In the next cell, we will create the <code class="docutils literal notranslate"><span class="pre">ConcreteModel</span></code> and the
<code class="docutils literal notranslate"><span class="pre">FlowsheetBlock</span></code>, and attach the flowsheet block to the Pyomo model.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the cell below to create the objects</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">FlowsheetBlock</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dynamic&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<p>At this point, we have a single Pyomo model that contains an (almost)
empty flowsheet block.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Use the pprint method on the model, i.e. m.pprint(), to
see what is currently contained in the model.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: call pprint on the model</span>
<span class="n">m</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">Block</span> <span class="n">Declarations</span>
    <span class="n">fs</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Active</span><span class="o">=</span><span class="kc">True</span>
        <span class="mi">1</span> <span class="n">Set</span> <span class="n">Declarations</span>
            <span class="n">_time</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Ordered</span><span class="o">=</span><span class="n">Insertion</span>
                <span class="n">Key</span>  <span class="p">:</span> <span class="n">Dimen</span> <span class="p">:</span> <span class="n">Domain</span> <span class="p">:</span> <span class="n">Size</span> <span class="p">:</span> <span class="n">Members</span>
                <span class="kc">None</span> <span class="p">:</span>     <span class="mi">1</span> <span class="p">:</span>    <span class="n">Any</span> <span class="p">:</span>    <span class="mi">1</span> <span class="p">:</span>  <span class="p">{</span><span class="mf">0.0</span><span class="p">,}</span>

        <span class="mi">1</span> <span class="n">Declarations</span><span class="p">:</span> <span class="n">_time</span>

<span class="mi">1</span> <span class="n">Declarations</span><span class="p">:</span> <span class="n">fs</span>
</pre></div>
</div>
</section>
<section id="define-properties">
<h2>Define Properties<a class="headerlink" href="#define-properties" title="Permalink to this headline">¶</a></h2>
<p>We need to define the property package for our flowsheet. In this
example, we will be using the ideal property package that is available
as part of the IDAES framework. This property package supports ideal gas
- ideal liquid, ideal gas - NRTL, and ideal gas - Wilson models for VLE.
More details on this property package can be found at:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/latest/technical_specs/model_libraries/generic/property_models/activity_coefficient.html">https://idaes-pse.readthedocs.io/en/latest/technical_specs/model_libraries/generic/property_models/activity_coefficient.html</a></p>
<p>IDAES also supports creation of your own property packages that allow
for specification of the fluid using any set of valid state variables
(e.g., component molar flows vs overall flow and mole fractions). This
flexibility is designed to support advanced modeling needs that may rely
on specific formulations. To learn about creating your own property
package, please consult the online documentation at:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/latest/user_guide/components/property_package/index.html">https://idaes-pse.readthedocs.io/en/latest/user_guide/components/property_package/index.html</a>
and look at examples within IDAES</p>
<p>For this workshop, we will import the BTX_activity_coeff_VLE property
parameter block to be used in the flowsheet. This properties block will
be passed to our unit model to define the appropriate state variables
and equations for performing thermodynamic calculations.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the following two cells to import and create
the properties block.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">idaes.generic_models.properties.activity_coeff_models.BTX_activity_coeff_VLE</span> \
    <span class="kn">import</span> <span class="nn">BTXParameterBlock</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">BTXParameterBlock</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;valid_phase&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Liq&#39;</span><span class="p">,</span> <span class="s1">&#39;Vap&#39;</span><span class="p">),</span>
                                            <span class="s2">&quot;activity_coeff_model&quot;</span><span class="p">:</span> <span class="s2">&quot;Ideal&quot;</span><span class="p">,</span>
                                            <span class="s2">&quot;state_vars&quot;</span><span class="p">:</span> <span class="s2">&quot;FTPz&quot;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="adding-flash-unit">
<h2>Adding Flash Unit<a class="headerlink" href="#adding-flash-unit" title="Permalink to this headline">¶</a></h2>
<p>Now that we have the flowsheet and the properties defined, we can create
the flash unit and add it to the flowsheet.</p>
<p><strong>The Unit Model Library within IDAES includes a large set of common
unit operations (see the online documentation for details:
https://idaes-pse.readthedocs.io/en/latest/technical_specs/model_libraries/generic/unit_models/index.html</strong></p>
<p>IDAES also fully supports the development of customized unit models
(which we will see in a later module).</p>
<p>Some of the IDAES pre-written unit models: * Mixer / Splitter * Heater
/ Cooler * Heat Exchangers (simple and 1D discretized) * Flash *
Reactors (kinetic, equilibrium, gibbs, stoichiometric conversion) *
Pressure changing equipment (compressors, expanders, pumps) * Feed and
Product (source / sink) components</p>
<p>In this module, we will import the <code class="docutils literal notranslate"><span class="pre">Flash</span></code> unit model from
<code class="docutils literal notranslate"><span class="pre">idaes.generic_models.unit_models</span></code> and create an instance of the flash
unit, attaching it to the flowsheet. Each IDAES unit model has several
configurable options to customize the model behavior, but also includes
defaults for these options. In this example, we will specify that the
property package to be used with the Flash is the one we created
earlier.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the following two cells to import the Flash and
create an instance of the unit model, attaching it to the flowsheet
object.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">idaes.generic_models.unit_models</span> <span class="kn">import</span> <span class="n">Flash</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span> <span class="o">=</span> <span class="n">Flash</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;property_package&quot;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">properties</span><span class="p">})</span>
</pre></div>
</div>
<p>At this point, we have created a flowsheet and a properties block. We
have also created a flash unit and added it to the flowsheet. Under the
hood, IDAES has created the required state variables and model
equations. Everything is open. You can see these variables and equations
by calling the Pyomo method <code class="docutils literal notranslate"><span class="pre">pprint</span></code> on the model, flowsheet, or flash
tank objects. Note that this output is very exhaustive, and is not
intended to provide any summary information about the model, but rather
a complete picture of all of the variables and equations in the model.</p>
</section>
<section id="set-operating-conditions">
<h2>Set Operating Conditions<a class="headerlink" href="#set-operating-conditions" title="Permalink to this headline">¶</a></h2>
<p>Now that we have created our unit model, we can specify the necessary
operating conditions. It is often very useful to determine the degrees
of freedom before we specify any conditions.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">idaes.core.util.model_statistics</span></code> package has a function
<code class="docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code>. To see how to use this function, we can make use
of the Python function <code class="docutils literal notranslate"><span class="pre">help(func)</span></code>. This function prints the
appropriate documentation string for the function.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Import the degrees_of_freedom function and print the
help for the function by calling the Python help function.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: import the degrees_of_freedom function from the idaes.core.util.model_statistics package</span>
<span class="kn">from</span> <span class="nn">idaes.core.util.model_statistics</span> <span class="kn">import</span> <span class="n">degrees_of_freedom</span>

<span class="c1"># Todo: Call the python help on the degrees_of_freedom function</span>
<span class="n">help</span><span class="p">(</span><span class="n">degrees_of_freedom</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">degrees_of_freedom</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">idaes</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">model_statistics</span><span class="p">:</span>

<span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="n">Method</span> <span class="n">to</span> <span class="k">return</span> <span class="n">the</span> <span class="n">degrees</span> <span class="n">of</span> <span class="n">freedom</span> <span class="n">of</span> <span class="n">a</span> <span class="n">model</span><span class="o">.</span>

    <span class="n">Args</span><span class="p">:</span>
        <span class="n">block</span> <span class="p">:</span> <span class="n">model</span> <span class="n">to</span> <span class="n">be</span> <span class="n">studied</span>

    <span class="n">Returns</span><span class="p">:</span>
        <span class="n">Number</span> <span class="n">of</span> <span class="n">degrees</span> <span class="n">of</span> <span class="n">freedom</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span>
</pre></div>
</div>
<div class="alert alert-block alert-info"><p>Inline Exercise: Now print the degrees of freedom for your model. The
result should be 7.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: print the degrees of freedom for your model</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degrees of Freedom =&quot;</span><span class="p">,</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Degrees</span> <span class="n">of</span> <span class="n">Freedom</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
<p>To satisfy our degrees of freedom, we will first specify the inlet
conditions. We can specify these values through the <code class="docutils literal notranslate"><span class="pre">inlet</span></code> port of
the flash unit.</p>
<p><strong>To see the list of naming conventions for variables within the IDAES
framework, consult the online documentation at:
https://idaes-pse.readthedocs.io/en/latest/user_guide/conventions.html#standard-naming-format</strong></p>
<p>As an example, to fix the molar flow of the inlet to be 1.0, you can use
the following notation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>To specify variables that are indexed by components, you can use the
following notation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-warning"><p>Note: The “0” in the indexing of the component mole fraction is present
because IDAES models support both dynamic and steady state simulation,
and the “0” refers to a timestep. Dynamic modeling is beyond the scope
of this workshop. Since we are performing steady state modeling, there
is only a single timestep in the model.</p>
</div><p>In the next cell, we will specify the inlet conditions. To satisfy the
remaining degrees of freedom, we will make two additional specifications
on the flash tank itself. The names of the key variables within the
Flash unit model can also be found in the online documentation:
<a class="reference external" href="https://idaes-pse.readthedocs.io/en/latest/technical_specs/model_libraries/generic/unit_models/flash.html#variables">https://idaes-pse.readthedocs.io/en/latest/technical_specs/model_libraries/generic/unit_models/flash.html#variables</a>.</p>
<p>To specify the value of a variable on the unit itself, use the following
notation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>For this module, we will use the following specifications: * inlet
overall molar flow = 1.0 (<code class="docutils literal notranslate"><span class="pre">flow_mol</span></code>) * inlet temperature = 368 K
(<code class="docutils literal notranslate"><span class="pre">temperature</span></code>) * inlet pressure = 101325 Pa (<code class="docutils literal notranslate"><span class="pre">pressure</span></code>) * inlet
mole fraction (benzene) = 0.5 (<code class="docutils literal notranslate"><span class="pre">mole_frac_comp[0,</span> <span class="pre">&quot;benzene&quot;]</span></code>) *
inlet mole fraction (toluene) = 0.5 (<code class="docutils literal notranslate"><span class="pre">mole_frac_comp[0,</span> <span class="pre">&quot;toluene&quot;]</span></code>)
* The heat duty on the flash set to 0 (<code class="docutils literal notranslate"><span class="pre">heat_duty</span></code>) * The pressure
drop across the flash tank set to 0 (<code class="docutils literal notranslate"><span class="pre">deltaP</span></code>)</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Write the code below to specify the inlet conditions
and unit specifications described above</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: Add inlet specifications given above</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">368</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">101325</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">inlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;toluene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Todo: Add 2 flash unit specifications given above</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">deltaP</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="alert alert-block alert-info"><p>Inline Exercise: Check the degrees of freedom again to ensure that the
system is now square. You should see that the degrees of freedom is now
0.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: print the degrees of freedom for your model</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degrees of Freedom =&quot;</span><span class="p">,</span> <span class="n">degrees_of_freedom</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Degrees</span> <span class="n">of</span> <span class="n">Freedom</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="initializing-the-model">
<h2>Initializing the Model<a class="headerlink" href="#initializing-the-model" title="Permalink to this headline">¶</a></h2>
<p>IDAES includes pre-written initialization routines for all unit models.
You can call this initialize method on the units. In the next module, we
will demonstrate the use of a sequential modular solve cycle to
initialize flowsheets.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Call the initialize method on the flash unit to
initialize the model.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: initialize the flash unit</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">1</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">2</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">3</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">4</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">5</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">1</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">2</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">3</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">4</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Step</span> <span class="mi">5</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_out</span><span class="p">:</span> <span class="n">State</span> <span class="n">Released</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">control_volume</span><span class="o">.</span><span class="n">properties_in</span><span class="p">:</span> <span class="n">State</span> <span class="n">Released</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">50</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">idaes</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="p">:</span> <span class="n">Initialization</span> <span class="n">Complete</span><span class="p">:</span> <span class="n">optimal</span> <span class="o">-</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span>
</pre></div>
</div>
<p>Now that the model has been defined and intialized, we can solve the
model.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Using the notation described in the previous model,
create an instance of the “ipopt” solver and use it to solve the model.
Set the tee option to True to see the log output.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: create the ipopt solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;ipopt&#39;</span><span class="p">)</span>

<span class="c1"># Todo: solve the model</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2:

<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:      135
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:       55

Total number of variables............................:       41
                     variables with only lower bounds:        3
                variables with lower and upper bounds:       10
                     variables with only upper bounds:        0
Total number of equality constraints.................:       41
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 2.91e-11 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0

Number of Iterations....: 0

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   9.7603753480903075e-13    2.9103830456733704e-11
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   9.7603753480903075e-13    2.9103830456733704e-11


Number of objective function evaluations             = 1
Number of objective gradient evaluations             = 1
Number of equality constraint evaluations            = 1
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      0.000
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.
</pre>
</section>
<section id="viewing-the-results">
<h2>Viewing the Results<a class="headerlink" href="#viewing-the-results" title="Permalink to this headline">¶</a></h2>
<p>Once a model is solved, the values returned by the solver are loaded
into the model object itself. We can access the value of any variable in
the model with the <code class="docutils literal notranslate"><span class="pre">value</span></code> function. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vap. Outlet Temperature = &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>You can also find more information about a variable or an entire port
using the <code class="docutils literal notranslate"><span class="pre">display</span></code> method from Pyomo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the cells below to show the current value of
the flash vapor outlet pressure. This cell also shows use of the display
function to see the values of the variables in the vap_outlet and the
liq_outlet.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the pressure of the flash vapor outlet</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pressure =&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">pressure</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Output from display:&#39;</span><span class="p">)</span>
<span class="c1"># Call display on vap_outlet and liq_outlet of the flash</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">liq_outlet</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pressure</span> <span class="o">=</span> <span class="mf">101325.0</span>

<span class="n">Output</span> <span class="kn">from</span> <span class="nn">display</span><span class="p">:</span>
<span class="n">vap_outlet</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">Key</span>  <span class="p">:</span> <span class="n">Name</span>           <span class="p">:</span> <span class="n">Value</span>
    <span class="kc">None</span> <span class="p">:</span>       <span class="n">flow_mol</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">0.39611817487742085</span><span class="p">}</span>
         <span class="p">:</span> <span class="n">mole_frac_comp</span> <span class="p">:</span> <span class="p">{(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">):</span> <span class="mf">0.6339766485081284</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">):</span> <span class="mf">0.3660233514918713</span><span class="p">}</span>
         <span class="p">:</span>       <span class="n">pressure</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">101325.0</span><span class="p">}</span>
         <span class="p">:</span>    <span class="n">temperature</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">368.0</span><span class="p">}</span>
<span class="n">liq_outlet</span> <span class="p">:</span> <span class="n">Size</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">Key</span>  <span class="p">:</span> <span class="n">Name</span>           <span class="p">:</span> <span class="n">Value</span>
    <span class="kc">None</span> <span class="p">:</span>       <span class="n">flow_mol</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">0.6038818251225793</span><span class="p">}</span>
         <span class="p">:</span> <span class="n">mole_frac_comp</span> <span class="p">:</span> <span class="p">{(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;benzene&#39;</span><span class="p">):</span> <span class="mf">0.41211759772293016</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;toluene&#39;</span><span class="p">):</span> <span class="mf">0.5878824022770697</span><span class="p">}</span>
         <span class="p">:</span>       <span class="n">pressure</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">101325.0</span><span class="p">}</span>
         <span class="p">:</span>    <span class="n">temperature</span> <span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="mf">368.0</span><span class="p">}</span>
</pre></div>
</div>
<p>The output from <code class="docutils literal notranslate"><span class="pre">display</span></code> is quite exhaustive and not really intended
to provide quick summary information. Because Pyomo is built on Python,
there are opportunities to format the output any way we like. Most IDAES
models have a <code class="docutils literal notranslate"><span class="pre">report</span></code> method which provides a summary of the results
for the model.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the cell below which uses the function above to
print a summary of the key variables in the flash model, including the
inlet, the vapor, and the liquid ports.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================================================================================</span>
<span class="n">Unit</span> <span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">flash</span>                                                            <span class="n">Time</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Unit</span> <span class="n">Performance</span>

    <span class="n">Variables</span><span class="p">:</span>

    <span class="n">Key</span>             <span class="p">:</span> <span class="n">Value</span>  <span class="p">:</span> <span class="n">Fixed</span> <span class="p">:</span> <span class="n">Bounds</span>
          <span class="n">Heat</span> <span class="n">Duty</span> <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">Pressure</span> <span class="n">Change</span> <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span>  <span class="kc">True</span> <span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="o">------------------------------------------------------------------------------------</span>
    <span class="n">Stream</span> <span class="n">Table</span>
                              <span class="n">Inlet</span>    <span class="n">Vapor</span> <span class="n">Outlet</span>  <span class="n">Liquid</span> <span class="n">Outlet</span>
    <span class="n">flow_mol</span>                   <span class="mf">1.0000</span>      <span class="mf">0.39612</span>       <span class="mf">0.60388</span>
    <span class="n">mole_frac_comp</span> <span class="n">benzene</span>    <span class="mf">0.50000</span>      <span class="mf">0.63398</span>       <span class="mf">0.41212</span>
    <span class="n">mole_frac_comp</span> <span class="n">toluene</span>    <span class="mf">0.50000</span>      <span class="mf">0.36602</span>       <span class="mf">0.58788</span>
    <span class="n">temperature</span>                <span class="mf">368.00</span>       <span class="mf">368.00</span>        <span class="mf">368.00</span>
    <span class="n">pressure</span>               <span class="mf">1.0132e+05</span>   <span class="mf">1.0132e+05</span>    <span class="mf">1.0132e+05</span>
<span class="o">====================================================================================</span>
</pre></div>
</div>
</section>
<section id="studying-purity-as-a-function-of-heat-duty">
<h2>Studying Purity as a Function of Heat Duty<a class="headerlink" href="#studying-purity-as-a-function-of-heat-duty" title="Permalink to this headline">¶</a></h2>
<p>Since the entire modeling framework is built upon Python, it includes a
complete programming environment for whatever analysis we may want to
perform. In this next exercise, we will make use of what we learned in
this and the previous module to generate a figure showing some output
variables as a function of the heat duty in the flash tank.</p>
<p>First, let’s import the matplotlib package for plotting as we did in the
previous module.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Execute the cell below to import matplotlib
appropriately.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Exercise specifications: * Generate a figure showing the flash tank
heat duty (<code class="docutils literal notranslate"><span class="pre">m.fs.flash.heat_duty[0]</span></code>) vs. the vapor flowrate
(<code class="docutils literal notranslate"><span class="pre">m.fs.flash.vap_outlet.flow_mol[0]</span></code>) * Specify the heat duty from
-17000 to 25000 over 50 steps</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Using what you have learned so far, fill in the missing
code below to generate the figure specified above. (Hint: import numpy
and use the linspace function from the previous module)</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the solve_successful checking function from workshop tools</span>
<span class="kn">from</span> <span class="nn">workshoptools</span> <span class="kn">import</span> <span class="n">solve_successful</span>

<span class="c1"># Todo: import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># create the empty lists to store the results that will be plotted</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># re-initialize model</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

<span class="c1"># Todo: Write the for loop specification using numpy&#39;s linspace</span>
<span class="k">for</span> <span class="n">duty</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">17000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="c1"># fix the heat duty</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">duty</span><span class="p">)</span>

    <span class="c1"># append the value of the duty to the Q list</span>
    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duty</span><span class="p">)</span>

    <span class="c1"># print the current simulation</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating with Q = &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># Solve the model</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># append the value for vapor fraction if the solve was successful</span>
    <span class="k">if</span> <span class="n">solve_successful</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">flow_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... solve successful.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... solve failed.&#39;</span><span class="p">)</span>

<span class="c1"># Create and show the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;Vapor Fraction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heat Duty [J]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Vapor Fraction [-]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">17000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">16142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">15285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">14428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">13571.428571428572</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">12714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">11857.142857142857</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">11000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">10142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">9285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">8428.57142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">6714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">5857.142857142857</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">5000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">4142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">3285.7142857142862</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">2428.5714285714294</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">714.2857142857156</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">142.8571428571413</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">1000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">1857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">2714.2857142857138</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">3571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">4428.5714285714275</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">5285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">6142.857142857141</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">7000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">7857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">8714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">9571.428571428569</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">10428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">11285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">12142.857142857141</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">13000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">13857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">14714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">15571.428571428569</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">16428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">17285.714285714283</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">18142.857142857145</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">19000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">19857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">20714.28571428571</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">21571.428571428572</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">22428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">23285.714285714283</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">24142.857142857145</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">25000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
</pre></div>
</div>
<img alt="../../_images/output_32_1.png" src="../../_images/output_32_1.png" />
<div class="alert alert-block alert-info"><p>Inline Exercise: Repeate the exercise above, but create a figure showing
the heat duty vs. the mole fraction of Benzene in the vapor outlet.
Remove any unnecessary printing to create cleaner results.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Todo: generate a figure of heat duty vs. mole fraction of Benzene in the vapor</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">duty</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">17000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="c1"># fix the heat duty</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">duty</span><span class="p">)</span>

    <span class="c1"># append the value of the duty to the Q list</span>
    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duty</span><span class="p">)</span>

    <span class="c1"># print the current simulation</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating with Q = &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># solve the model</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># append the value for vapor fraction if the solve was successful</span>
    <span class="k">if</span> <span class="n">solve_successful</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... solve successful.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... solve failed.&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;Purity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heat Duty [J]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Vapor Benzene Mole Fraction [-]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">17000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">16142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">15285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">14428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">13571.428571428572</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">12714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">11857.142857142857</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">11000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">10142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">9285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">8428.57142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">6714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">5857.142857142857</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">5000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">4142.857142857143</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">3285.7142857142862</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">2428.5714285714294</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">714.2857142857156</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">142.8571428571413</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">1000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">1857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">2714.2857142857138</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">3571.4285714285725</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">4428.5714285714275</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">5285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">6142.857142857141</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">7000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">7857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">8714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">9571.428571428569</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">10428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">11285.714285714286</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">12142.857142857141</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">13000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">13857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">14714.285714285714</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">15571.428571428569</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">16428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">17285.714285714283</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">18142.857142857145</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">19000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">19857.142857142855</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">20714.28571428571</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">21571.428571428572</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">22428.571428571428</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">23285.714285714283</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">24142.857142857145</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Simulating</span> <span class="k">with</span> <span class="n">Q</span> <span class="o">=</span>  <span class="mf">25000.0</span>
<span class="o">...</span> <span class="n">solve</span> <span class="n">successful</span><span class="o">.</span>
</pre></div>
</div>
<img alt="../../_images/output_34_1.png" src="../../_images/output_34_1.png" />
<p>Recall that the IDAES framework is an equation-oriented modeling
environment. This means that we can specify “design” problems natively.
That is, there is no need to have our specifications on the inlet alone.
We can put specifications on the outlet as long as we retain a
well-posed, square system of equations.</p>
<p>For example, we can remove the specification on heat duty and instead
specify that we want the mole fraction of Benzene in the vapor outlet to
be equal to 0.6. The mole fraction is not a native variable in the
property block, so we cannot use “fix”. We can, however, add a
constraint to the model.</p>
<p>Note that we have been executing a number of solves on the problem, and
may not be sure of the current state. To help convergence, therefore, we
will first call initialize, then add the new constraint and solve the
problem. Note that the reference for the mole fraction of Benzene in the
vapor outlet is <code class="docutils literal notranslate"><span class="pre">m.fs.flash.vap_outlet.mole_frac_comp[0,</span> <span class="pre">&quot;benzene&quot;]</span></code>.</p>
<div class="alert alert-block alert-info"><p>Inline Exercise: Fill in the missing code below and add a constraint on
the mole fraction of Benzene (to a value of 0.6) to find the required
heat duty.</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># re-initialize the model - this may or may not be required depending on current state but safe to initialize</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">outlvl</span><span class="o">=</span><span class="n">idaeslog</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

<span class="c1"># Unfix the heat_duty variable</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">heat_duty</span><span class="o">.</span><span class="n">unfix</span><span class="p">()</span>

<span class="c1"># Todo: Add a new constraint (benzene mole fraction to 0.6)</span>
<span class="n">m</span><span class="o">.</span><span class="n">benz_purity_con</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">vap_outlet</span><span class="o">.</span><span class="n">mole_frac_comp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;benzene&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># solve the problem</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Check stream condition</span>
<span class="n">m</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">flash</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
<pre class="literal-block">Ipopt 3.13.2:

<strong>**************************************************************************</strong>
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit <a class="reference external" href="http://projects.coin-or.org/Ipopt">http://projects.coin-or.org/Ipopt</a>

This version of Ipopt was compiled from source code available at
    <a class="reference external" href="https://github.com/IDAES/Ipopt">https://github.com/IDAES/Ipopt</a> as part of the Institute for the Design of
    Advanced Energy Systems Process Systems Engineering Framework (IDAES PSE
    Framework) Copyright (c) 2018-2019. See <a class="reference external" href="https://github.com/IDAES/idaes-pse">https://github.com/IDAES/idaes-pse</a>.

This version of Ipopt was compiled using HSL, a collection of Fortran codes
    for large-scale scientific computation.  All technical papers, sales and
    publicity material resulting from use of the HSL codes within IPOPT must
    contain the following acknowledgement:
        HSL, a collection of Fortran codes for large-scale scientific
        computation. See <a class="reference external" href="http://www.hsl.rl.ac.uk">http://www.hsl.rl.ac.uk</a>.
<strong>**************************************************************************</strong>

This is Ipopt version 3.13.2, running with linear solver ma27.

Number of nonzeros in equality constraint Jacobian...:      137
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:       55

Total number of variables............................:       42
                     variables with only lower bounds:        3
                variables with lower and upper bounds:       10
                     variables with only upper bounds:        0
Total number of equality constraints.................:       42
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 3.40e-02 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  0.0000000e+00 1.64e+02 7.01e-02  -1.0 5.15e+03    -  9.87e-01 1.00e+00h  1
   2  0.0000000e+00 9.59e-02 2.03e-03  -1.0 7.07e+01    -  9.90e-01 1.00e+00h  1
   3  0.0000000e+00 6.96e-08 2.50e-06  -1.0 4.13e-01    -  9.98e-01 1.00e+00h  1

Number of Iterations....: 3

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   0.0000000000000000e+00    0.0000000000000000e+00
Constraint violation....:   8.9168059540348004e-11    6.9563611759804189e-08
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   8.9168059540348004e-11    6.9563611759804189e-08


Number of objective function evaluations             = 4
Number of objective gradient evaluations             = 4
Number of equality constraint evaluations            = 4
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 4
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 3
Total CPU secs in IPOPT (w/o function evaluations)   =      0.001
Total CPU secs in NLP function evaluations           =      0.000

EXIT: Optimal Solution Found.

====================================================================================
Unit : fs.flash                                                            Time: 0.0
------------------------------------------------------------------------------------
    Unit Performance

    Variables:

    Key             : Value  : Fixed : Bounds
          Heat Duty : 5083.6 : False : (None, None)
    Pressure Change : 0.0000 :  True : (None, None)

------------------------------------------------------------------------------------
    Stream Table
                              Inlet    Vapor Outlet  Liquid Outlet
    flow_mol                   1.0000      0.54833       0.45167
    mole_frac_comp benzene    0.50000      0.60000       0.37860
    mole_frac_comp toluene    0.50000      0.40000       0.62140
    temperature                368.00       369.07        369.07
    pressure               1.0132e+05   1.0132e+05    1.0132e+05
====================================================================================</pre>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>