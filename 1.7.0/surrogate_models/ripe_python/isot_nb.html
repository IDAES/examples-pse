

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; IDAES v1.7.0 Examples</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> IDAES Examples
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../workshops/index.html">IDAES Workshop Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">IDAES Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Surrogate Modeling Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matopt/index.html">MatOpt Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IDAES Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/surrogate_models/ripe_python/isot_nb.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>Example from:</p>
<p>Wilson, Zachary T., and Nikolaos V. Sahinidis. “Automated learning of
chemical reaction networks.” Computers &amp; Chemical Engineering 127
(2019): 88-98. <a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2019.05.020">https://doi.org/10.1016/j.compchemeng.2019.05.020</a></p>
<p><em>Case 1: Isothermal CSTR</em></p>
<p>For isothermal CSTRs across a known range of feed concentrations,
<span class="math notranslate nohighlight">\(C_s^l \leq C_s^0 \leq C_s^u\)</span>, s <span class="math notranslate nohighlight">\(\in\)</span> F.</p>
<p>The simulated reaction networks id defined below, where
<span class="math notranslate nohighlight">\(k_1^{true} = 1.5\)</span>, <span class="math notranslate nohighlight">\(k_2^{true} = 2.1\)</span>, and
<span class="math notranslate nohighlight">\(k_3^{true} = 0.9\)</span> with a residence time of <span class="math notranslate nohighlight">\(\tau = 1\)</span> is
used for the reactor.</p>
<p><span class="math notranslate nohighlight">\(A + B \rightarrow C \quad \{{k_1^{true}}\}\)</span></p>
<p><span class="math notranslate nohighlight">\(B + C \rightarrow D \quad \{{k_2^{true}}\}\)</span></p>
<p><span class="math notranslate nohighlight">\(A + D \rightarrow E \quad \{{k_3^{true}}\}\)</span></p>
<p>Initial concentrations are specificed for species <span class="math notranslate nohighlight">\(F = {A,B}\)</span> over
the range <span class="math notranslate nohighlight">\(0 \leq C_s^0 \leq 10\)</span>, <span class="math notranslate nohighlight">\(s\in F\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>

<span class="kn">import</span> <span class="nn">pyomo.environ</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">from</span> <span class="nn">idaes.surrogate</span> <span class="kn">import</span> <span class="n">ripe</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">isotsim</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Setup the problem</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># number of species</span>
<span class="n">lb_conc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ub_conc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># initial concentrations - only 2 data points</span>
<span class="n">cdata0</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">cdata</span> <span class="o">=</span> <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">cdata0</span><span class="p">)</span>
<span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cdata0</span><span class="p">)</span> <span class="c1"># number of data points</span>

<span class="c1"># Expected variance based off the noise in the data</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">noise</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cdata</span><span class="p">))</span>
</pre></div>
</div>
<p>The postulated set reaction stoichiometries is defined as:</p>
<p>$ A + B :raw-latex:<a href="#id1"><span class="problematic" id="id2">`</span></a>rightarrow <a href="#id3"><span class="problematic" id="id4">`</span></a>C $</p>
<p>$ B + C :raw-latex:<a href="#id5"><span class="problematic" id="id6">`</span></a>rightarrow <a href="#id7"><span class="problematic" id="id8">`</span></a>D $</p>
<p>$ A + D :raw-latex:<a href="#id9"><span class="problematic" id="id10">`</span></a>rightarrow <a href="#id11"><span class="problematic" id="id12">`</span></a>E $</p>
<p>$ A + 2B :raw-latex:<a href="#id13"><span class="problematic" id="id14">`</span></a>rightarrow <a href="#id15"><span class="problematic" id="id16">`</span></a>D $</p>
<p>$ 2A + 2B :raw-latex:<a href="#id17"><span class="problematic" id="id18">`</span></a>rightarrow <a href="#id19"><span class="problematic" id="id20">`</span></a>E $</p>
<p>$ A + B + C :raw-latex:<a href="#id21"><span class="problematic" id="id22">`</span></a>rightarrow <a href="#id23"><span class="problematic" id="id24">`</span></a>E $</p>
<p>$ 2A + B + D :raw-latex:<a href="#id25"><span class="problematic" id="id26">`</span></a>rightarrow <a href="#id27"><span class="problematic" id="id28">`</span></a>C + E$</p>
<p>$ C + D :raw-latex:<a href="#id29"><span class="problematic" id="id30">`</span></a>rightarrow <a href="#id31"><span class="problematic" id="id32">`</span></a>E + A $</p>
<p>$ 3A + 3B :raw-latex:<a href="#id33"><span class="problematic" id="id34">`</span></a>rightarrow <a href="#id35"><span class="problematic" id="id36">`</span></a>C + E $</p>
<p>$ 3A + 4B :raw-latex:<a href="#id37"><span class="problematic" id="id38">`</span></a>rightarrow <a href="#id39"><span class="problematic" id="id40">`</span></a>D + E $</p>
<p>$ 2A + 3B :raw-latex:<a href="#id41"><span class="problematic" id="id42">`</span></a>rightarrow <a href="#id43"><span class="problematic" id="id44">`</span></a>C + D $</p>
<p>$ 4A + 5B :raw-latex:<a href="#id45"><span class="problematic" id="id46">`</span></a>rightarrow <a href="#id47"><span class="problematic" id="id48">`</span></a>C + D + E $</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># considered reaction stoichiometries</span>
<span class="c1">#            A   B   C   D   E</span>
<span class="n">stoich</span> <span class="o">=</span> <span class="p">[[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<p>We have the initial conditions and possible stoichiometries to consider,
but we still need the kinetics reaction mechanisms. Reaction mechanisms
require a stoichiometry and kinetic model. In this case, we will be
using mass action kinetics for all the stoichiometries available, which
is built into RIPE.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># IRIPE internal mass action kinetics are specified</span>
<span class="n">rxn_mechs</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;massact&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>Now we are ready to run the RIPE model builder:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">ripe</span><span class="o">.</span><span class="n">ripemodel</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span>
                             <span class="n">stoich</span> <span class="o">=</span> <span class="n">stoich</span><span class="p">,</span>
                             <span class="n">mechanisms</span><span class="o">=</span><span class="n">rxn_mechs</span><span class="p">,</span>
                             <span class="n">x0</span><span class="o">=</span><span class="n">cdata0</span><span class="p">,</span>
                             <span class="n">hide_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                             <span class="n">deltaterm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">expand_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ksb</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">examples</span><span class="o">-</span><span class="n">rel</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">_asarray</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span> <span class="n">VisibleDeprecationWarning</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">an</span> <span class="n">ndarray</span> <span class="kn">from</span> <span class="nn">ragged</span> <span class="n">nested</span> <span class="n">sequences</span> <span class="p">(</span><span class="n">which</span> <span class="ow">is</span> <span class="n">a</span> <span class="nb">list</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="nb">tuple</span> <span class="n">of</span> <span class="n">lists</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">tuples</span><span class="o">-</span><span class="ow">or</span> <span class="n">ndarrays</span> <span class="k">with</span> <span class="n">different</span> <span class="n">lengths</span> <span class="ow">or</span> <span class="n">shapes</span><span class="p">)</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">meant</span> <span class="n">to</span> <span class="n">do</span> <span class="n">this</span><span class="p">,</span> <span class="n">you</span> <span class="n">must</span> <span class="n">specify</span> <span class="s1">&#39;dtype=object&#39;</span> <span class="n">when</span> <span class="n">creating</span> <span class="n">the</span> <span class="n">ndarray</span>
  <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
<span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">7676.227335597764</span>
<span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
<span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">217.65886843139467</span>
 <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">1</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
<span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.98250279281449</span>
<span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
  <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
        <span class="n">massact</span>
  <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
        <span class="mf">0.005408483826394419</span> <span class="o">+/-</span> <span class="mf">0.0004545044904325789</span>
</pre></div>
</div>
<p>Based on the number of data points, the best model chosen is only one
reaction.</p>
<p>$ 4A + 5B :raw-latex:<a href="#id49"><span class="problematic" id="id50">`</span></a>rightarrow <a href="#id51"><span class="problematic" id="id52">`</span></a>C + D + E $</p>
<p>So similar to how ALAMO iterates between developing a model and adding
additional points with error maximization, RIPE provides methods to do
the same.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adaptive experimental design using error maximization sampling</span>
<span class="p">[</span><span class="n">new_points</span><span class="p">,</span> <span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">ripe</span><span class="o">.</span><span class="n">ems</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                             <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">,</span>
                             <span class="n">lb_conc</span><span class="p">,</span>
                             <span class="n">ub_conc</span><span class="p">,</span>
                             <span class="mi">5</span><span class="p">,</span> <span class="c1">#number of species</span>
                             <span class="n">x</span><span class="o">=</span><span class="n">cdata</span><span class="p">,</span>
                             <span class="n">x0</span><span class="o">=</span><span class="n">cdata0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Point&quot;</span><span class="p">,</span> <span class="n">new_points</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>

<span class="c1"># Implement EMS as described in the RIPE publication</span>
<span class="n">new_res</span> <span class="o">=</span> <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">new_points</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Result&quot;</span><span class="p">,</span><span class="n">new_res</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">New</span> <span class="n">Point</span> <span class="p">[</span><span class="mf">0.1210044378197439</span><span class="p">,</span> <span class="mf">8.493137312894218</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Error</span> <span class="p">[</span><span class="mf">0.07330054</span> <span class="mf">0.40303908</span> <span class="mf">0.00342167</span> <span class="mf">0.09326641</span> <span class="mf">0.00920652</span><span class="p">]</span>
<span class="n">New</span> <span class="n">Result</span> <span class="p">[</span><span class="mf">0.009825424488262973</span><span class="p">,</span> <span class="mf">8.106899913146474</span><span class="p">,</span> <span class="mf">0.005679995225770262</span><span class="p">,</span> <span class="mf">0.08203076769248263</span><span class="p">,</span> <span class="mf">0.000814427073297477</span><span class="p">]</span>
</pre></div>
</div>
<p>Running ripe.ems gives us additional points maximizing the error that we
can use to develop a new model until our error tolerance is achieved. A
common loop in using RIPE follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ite</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">err</span> <span class="o">&gt;</span>  <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">noise</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_res</span><span class="p">]</span> <span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Which concentrations violate error (True=violation) : &#39;</span><span class="p">,</span> <span class="n">err</span> <span class="o">&gt;</span> <span class="p">[</span><span class="n">noise</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_res</span><span class="p">])</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ite</span><span class="o">+=</span><span class="mi">1</span>

    <span class="c1"># Data updated explicitly</span>
    <span class="c1"># so RBFopt subroutines produce consistent results</span>

    <span class="n">new_cdata0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nd</span><span class="o">+</span><span class="n">ite</span><span class="p">,</span><span class="n">ns</span><span class="p">])</span>
    <span class="n">new_cdata</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nd</span><span class="o">+</span><span class="n">ite</span><span class="p">,</span><span class="n">ns</span><span class="p">])</span>
    <span class="n">new_cdata0</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">cdata0</span><span class="p">[:][:]</span>
    <span class="n">new_cdata</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">cdata</span><span class="p">[:][:]</span>
    <span class="n">new_cdata0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">new_points</span><span class="p">[:]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">new_points</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
        <span class="n">new_cdata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

    <span class="c1">#Update weight parameters</span>
    <span class="n">sigma</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">noise</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_cdata</span><span class="p">))</span>

    <span class="c1"># Build updated RIPE model</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">ripe</span><span class="o">.</span><span class="n">ripemodel</span><span class="p">(</span><span class="n">new_cdata</span><span class="p">,</span>
                             <span class="n">stoich</span> <span class="o">=</span> <span class="n">stoich</span><span class="p">,</span>
                             <span class="n">mechanisms</span><span class="o">=</span><span class="n">rxn_mechs</span><span class="p">,</span>
                             <span class="n">x0</span><span class="o">=</span><span class="n">new_cdata0</span><span class="p">,</span>
                             <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                             <span class="n">expand_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Another call to EMS</span>
    <span class="p">[</span><span class="n">new_points</span><span class="p">,</span> <span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">ripe</span><span class="o">.</span><span class="n">ems</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                                 <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">,</span>
                                 <span class="n">lb_conc</span><span class="p">,</span>
                                 <span class="n">ub_conc</span><span class="p">,</span>
                                 <span class="mi">5</span><span class="p">,</span>
                                 <span class="n">x</span><span class="o">=</span><span class="n">cdata</span><span class="p">,</span>
                                 <span class="n">x0</span><span class="o">=</span><span class="n">cdata0</span><span class="p">)</span>

    <span class="c1"># Update results</span>
    <span class="n">new_res</span> <span class="o">=</span> <span class="n">isotsim</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">new_points</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cdata0</span> <span class="o">=</span> <span class="n">new_cdata0</span>
    <span class="n">cdata</span> <span class="o">=</span> <span class="n">new_cdata</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Which</span> <span class="n">concentrations</span> <span class="n">violate</span> <span class="n">error</span> <span class="p">(</span><span class="kc">True</span><span class="o">=</span><span class="n">violation</span><span class="p">)</span> <span class="p">:</span>  <span class="p">[</span> <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span><span class="p">]</span>
   <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
 <span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">7852.505926585663</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">394.33590086967916</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">192.8266855066259</span>
  <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">2</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
 <span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.9798204946470818</span>
 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.25027178633435715</span> <span class="o">+/-</span> <span class="mf">0.3226366367553803</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.03365708108448949</span> <span class="o">+/-</span> <span class="mf">0.028202548251262054</span>

<span class="n">Which</span> <span class="n">concentrations</span> <span class="n">violate</span> <span class="n">error</span> <span class="p">(</span><span class="kc">True</span><span class="o">=</span><span class="n">violation</span><span class="p">)</span> <span class="p">:</span>  <span class="p">[</span> <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span><span class="p">]</span>
   <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
 <span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">8092.322976176563</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">634.1824626646737</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">366.7225675562089</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">3</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">54.81340171968461</span>
  <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">3</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
 <span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.9910763876617544</span>
 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.2880585341055448</span> <span class="o">+/-</span> <span class="mf">0.38315444847742086</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">2.098172503302784</span> <span class="o">+/-</span> <span class="mf">0.7954866297064689</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.8007999714779602</span> <span class="o">+/-</span> <span class="mf">0.2927610662940082</span>

<span class="n">Which</span> <span class="n">concentrations</span> <span class="n">violate</span> <span class="n">error</span> <span class="p">(</span><span class="kc">True</span><span class="o">=</span><span class="n">violation</span><span class="p">)</span> <span class="p">:</span>  <span class="p">[</span> <span class="kc">True</span> <span class="kc">False</span> <span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span><span class="p">]</span>
   <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
 <span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">8664.739596500396</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">1197.1316194887013</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">476.91131736942594</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">3</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">75.97136731411274</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">4</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">57.46538879486241</span>
  <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">4</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
 <span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.9871142878626313</span>
 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.2688357401994914</span> <span class="o">+/-</span> <span class="mf">0.3729620463366348</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.7826937502777407</span> <span class="o">+/-</span> <span class="mf">28.38790549172072</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.6193598117701142</span> <span class="o">+/-</span> <span class="mf">16.89439908362267</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.13681285367925855</span> <span class="o">+/-</span> <span class="mf">15.438984406082263</span>

<span class="n">Which</span> <span class="n">concentrations</span> <span class="n">violate</span> <span class="n">error</span> <span class="p">(</span><span class="kc">True</span><span class="o">=</span><span class="n">violation</span><span class="p">)</span> <span class="p">:</span>  <span class="p">[</span><span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span><span class="p">]</span>
   <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
 <span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">12142.088967298932</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">2190.5003459307422</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">1078.2244900635974</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">3</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">91.30827883877404</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">4</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">89.69992775217918</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">5</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">87.22808384330993</span>
  <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">5</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
 <span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.9856073242070885</span>
 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.2713266881310492</span> <span class="o">+/-</span> <span class="mf">1.5861679746112138</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.8900516221673038</span> <span class="o">+/-</span> <span class="mf">4.358639538773217</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.7168627372561096</span> <span class="o">+/-</span> <span class="mf">2.077445949006548</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.15773972058793848</span> <span class="o">+/-</span> <span class="mf">2.3605426481783947</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">5</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">5</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.0015480951691419773</span> <span class="o">+/-</span> <span class="mf">0.05667219580996613</span>
</pre></div>
</div>
<p>The results can vary, but RIPE can identify the simulated system of:</p>
<p><span class="math notranslate nohighlight">\(A + B \rightarrow C \quad \{{k_1^{true}}\}\)</span></p>
<p><span class="math notranslate nohighlight">\(B + C \rightarrow D \quad \{{k_2^{true}}\}\)</span></p>
<p><span class="math notranslate nohighlight">\(A + D \rightarrow E \quad \{{k_3^{true}}\}\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final call to RIPE to get concise output</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">ripe</span><span class="o">.</span><span class="n">ripemodel</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span>
                         <span class="n">stoich</span> <span class="o">=</span> <span class="n">stoich</span><span class="p">,</span>
                         <span class="n">mechanisms</span><span class="o">=</span><span class="n">rxn_mechs</span><span class="p">,</span>
                         <span class="n">x0</span><span class="o">=</span><span class="n">cdata0</span><span class="p">,</span>
                         <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                         <span class="n">expand_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="o">----</span> <span class="n">Calculating</span> <span class="n">null</span> <span class="n">values</span> <span class="k">for</span> <span class="n">model</span> <span class="n">selection</span> <span class="o">----</span>
 <span class="o">-</span> <span class="n">Null</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">12142.088967298932</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">1</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">2190.5003459307422</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">1078.2244900635974</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">3</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">91.30827883877404</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">4</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">89.69992775217918</span>
 <span class="o">-</span> <span class="n">Solving</span> <span class="n">RIPE</span> <span class="n">model</span> <span class="k">with</span> <span class="n">cardinality</span> <span class="n">constraint</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">-</span>
 <span class="o">-</span> <span class="mi">5</span><span class="o">-</span><span class="n">term</span> <span class="n">model</span> <span class="n">BIC</span> <span class="o">=</span> <span class="mf">87.22808384330993</span>
  <span class="o">----</span>  <span class="n">RIPE</span> <span class="n">selected</span> <span class="mi">5</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">optimal</span> <span class="n">reaction</span> <span class="n">network</span>  <span class="o">----</span>
 <span class="o">-+-</span>  <span class="n">Overall</span> <span class="n">R2</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">model</span> <span class="p">:</span> <span class="mf">0.9856073242070885</span>
 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">1</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.2713266881310492</span> <span class="o">+/-</span> <span class="mf">1.5861679746112138</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">2</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">1.8900516221673038</span> <span class="o">+/-</span> <span class="mf">4.358639538773217</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">3</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.7168627372561096</span> <span class="o">+/-</span> <span class="mf">2.077445949006548</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">4</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.15773972058793848</span> <span class="o">+/-</span> <span class="mf">2.3605426481783947</span>

 <span class="o">-</span> <span class="n">Stochiometry</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">5</span>
         <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="n">Mechanism</span> <span class="n">selected</span> <span class="k">for</span> <span class="n">reaction</span> <span class="mi">5</span>
         <span class="n">massact</span>
   <span class="n">Kinetic</span> <span class="n">rate</span> <span class="n">constant</span> <span class="o">&amp;</span> <span class="mi">95</span><span class="o">%</span> <span class="n">confidence</span> <span class="n">interval</span>
         <span class="mf">0.0015480951691419773</span> <span class="o">+/-</span> <span class="mf">0.05667219580996613</span>

<span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2713266881310492</span><span class="p">,</span> <span class="mf">1.8900516221673038</span><span class="p">,</span> <span class="mf">0.7168627372561096</span><span class="p">,</span> <span class="mf">0.15773972058793848</span><span class="p">,</span> <span class="mf">0.0015480951691419773</span><span class="p">],</span> <span class="s1">&#39;conf_inv&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5861679746112138</span><span class="p">,</span> <span class="mf">4.358639538773217</span><span class="p">,</span> <span class="mf">2.077445949006548</span><span class="p">,</span> <span class="mf">2.3605426481783947</span><span class="p">,</span> <span class="mf">0.05667219580996613</span><span class="p">],</span> <span class="s1">&#39;stoichiometry&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;mechanisms&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;massact&#39;</span><span class="p">,</span> <span class="s1">&#39;massact&#39;</span><span class="p">,</span> <span class="s1">&#39;massact&#39;</span><span class="p">,</span> <span class="s1">&#39;massact&#39;</span><span class="p">,</span> <span class="s1">&#39;massact&#39;</span><span class="p">]}</span>
</pre></div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        
        &copy; <a href="../../copyright.html">Copyright</a> DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>