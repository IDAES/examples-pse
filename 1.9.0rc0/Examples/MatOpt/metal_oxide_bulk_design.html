

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Perovskite Design &mdash; IDAES v1.9.0rc0 Examples</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!-- Add Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Arimo|Roboto&display=swap"
      rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> IDAES Examples
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/index.html">IDAES Tutorials</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IDAES Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Perovskite Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/Examples/MatOpt/metal_oxide_bulk_design.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="perovskite-design">
<h1>Perovskite Design<a class="headerlink" href="#perovskite-design" title="Permalink to this headline">¶</a></h1>
<p>This notebook serves as an example application of the MatOpt framework
on bulk nanostructured materials. We consider the problem of how to
optimally place dopant in a perovskite lattice.</p>
<p>For more information, see: Hanselman, Christopher L., et al. “A
framework for optimizing oxygen vacancy formation in doped perovskites.”
<em>Computers &amp; Chemical Engineering</em> 126 (2019): 168-177. DOI:
<a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2019.03.033">10.1016/j.compchemeng.2019.03.033</a></p>
<div class="section" id="importing-packages">
<h2>Importing Packages<a class="headerlink" href="#importing-packages" title="Permalink to this headline">¶</a></h2>
<p>We start by importing MatOpt.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">idaes.apps.matopt</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="representing-materials">
<h2>Representing Materials<a class="headerlink" href="#representing-materials" title="Permalink to this headline">¶</a></h2>
<p>First, we construct a <strong>*Lattice*</strong> object to hold information about the
sites in our material. For this application, we use the
<strong>*PerovskiteLattice*</strong> class with lattice constants <em>A</em>, <em>B</em>, and <em>C</em>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">Lat</span> <span class="o">=</span> <span class="n">PerovskiteLattice</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we construct <strong>*Shape*</strong> and <strong>*Tiling*</strong> objects to help define
the material locations of interest. In this case, we use <strong>*RectPrism*</strong>
and <strong>*CubicTiling*</strong>, respectively.</p>
<p>Note that we shift the shape slightly to avoid ambiguity about which
sites on the border of the cell should be included.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nUnitCellsOnEdge</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">RectPrism</span><span class="p">(</span><span class="n">nUnitCellsOnEdge</span><span class="o">*</span><span class="n">A</span><span class="p">,</span>
              <span class="n">nUnitCellsOnEdge</span><span class="o">*</span><span class="n">B</span><span class="p">,</span>
              <span class="n">nUnitCellsOnEdge</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span><span class="p">]))</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">CubicTiling</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we construct the <strong>*Canvas*</strong> object which will hold all the
information about the sites and information about neighbors. We also
define a list of <strong>*Atom*</strong> objects that serve as the building blocks of
our material.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Canv</span> <span class="o">=</span> <span class="n">Canvas</span><span class="o">.</span><span class="n">fromLatticeAndTilingScan</span><span class="p">(</span><span class="n">Lat</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="n">Atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Ba&#39;</span><span class="p">),</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">),</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">),</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Finally, we load a list of conformations from file that represent a set
of dopant configurations that we would like to indicate in the design.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="n">iDesiredConfs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">394</span><span class="p">,</span><span class="mi">395</span><span class="p">,</span><span class="mi">396</span><span class="p">,</span><span class="mi">397</span><span class="p">,</span><span class="mi">398</span><span class="p">,</span><span class="mi">399</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">401</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span>
                 <span class="mi">70</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">167</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">169</span><span class="p">]</span>
<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">ConfDir</span><span class="p">:</span>
    <span class="n">ZipFile</span><span class="p">(</span><span class="s1">&#39;./confs.zip&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">ConfDir</span><span class="p">)</span>
    <span class="n">ConfDesigns</span> <span class="o">=</span> <span class="n">loadFromPDBs</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.pdb&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iDesiredConfs</span><span class="p">],</span> <span class="n">folder</span><span class="o">=</span><span class="n">ConfDir</span> <span class="o">+</span> <span class="s1">&#39;/confs/&#39;</span><span class="p">)</span>
<span class="n">Confs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Conf</span><span class="o">.</span><span class="n">Contents</span> <span class="k">for</span> <span class="n">Conf</span> <span class="ow">in</span> <span class="n">ConfDesigns</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="building-the-model">
<h2>Building the Model<a class="headerlink" href="#building-the-model" title="Permalink to this headline">¶</a></h2>
<p>To begin specifying the model, we first define several pieces of
information that will help specify the design problem.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Canv</span><span class="p">))]</span>
<span class="n">ASites</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Sites</span> <span class="k">if</span> <span class="n">Lat</span><span class="o">.</span><span class="n">isASite</span><span class="p">(</span><span class="n">Canv</span><span class="o">.</span><span class="n">Points</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
<span class="n">BSites</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Sites</span> <span class="k">if</span> <span class="n">Lat</span><span class="o">.</span><span class="n">isBSite</span><span class="p">(</span><span class="n">Canv</span><span class="o">.</span><span class="n">Points</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
<span class="n">OSites</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Sites</span> <span class="k">if</span> <span class="n">Lat</span><span class="o">.</span><span class="n">isOSite</span><span class="p">(</span><span class="n">Canv</span><span class="o">.</span><span class="n">Points</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
<span class="n">pctLocalLB</span><span class="p">,</span><span class="n">pctLocalUB</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>
<span class="n">pctGlobalLB</span><span class="p">,</span><span class="n">pctGlobalUB</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.3</span>
<span class="n">LocalBounds</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">)):(</span><span class="nb">round</span><span class="p">(</span><span class="n">pctLocalLB</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Canv</span><span class="o">.</span><span class="n">NeighborhoodIndexes</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span>
                               <span class="nb">round</span><span class="p">(</span><span class="n">pctLocalUB</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Canv</span><span class="o">.</span><span class="n">NeighborhoodIndexes</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">OSites</span><span class="p">}</span>
<span class="n">GlobalLB</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">pctGlobalLB</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">BSites</span><span class="p">))</span>
<span class="n">GlobalUB</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">pctGlobalUB</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">BSites</span><span class="p">))</span>
</pre></div>
</div>
<p>Next, we initialize a <strong>*MatOptModel*</strong> object that will hold all the
information about material descriptors and desired functionalities.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MatOptModel</span><span class="p">(</span><span class="n">Canv</span><span class="p">,</span><span class="n">Atoms</span><span class="p">,</span><span class="n">Confs</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, several basic variables are pre-defined. See the first
example, <strong>*Monometallic_Nanocluster_Design.ipynb*</strong> for a description
of basic variables, expressions, and constraint rules.</p>
<p>For this system, we introduce several rules about the allowed placement
of atoms in the design. First, we require that all A-sites in the
material are occupied by Ba. Next, we require that all O-sites are
occupied by O. Thirdly, we forbid Ba and O from being placed in B-sites.
And finally, we require that some atom be placed in each B-site. These
four rules effectively limit the scope of the optimization to focus on
the labeling of B-sites as either Fe or In.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">Yik</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixedTo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sites</span><span class="o">=</span><span class="n">ASites</span><span class="p">,</span><span class="n">site_types</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Ba&#39;</span><span class="p">)]))</span>
<span class="n">m</span><span class="o">.</span><span class="n">Yik</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixedTo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sites</span><span class="o">=</span><span class="n">OSites</span><span class="p">,</span><span class="n">site_types</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)]))</span>
<span class="n">m</span><span class="o">.</span><span class="n">Yik</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixedTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sites</span><span class="o">=</span><span class="n">BSites</span><span class="p">,</span><span class="n">site_types</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Ba&#39;</span><span class="p">),</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)]))</span>
<span class="n">m</span><span class="o">.</span><span class="n">Yi</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixedTo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sites</span><span class="o">=</span><span class="n">BSites</span><span class="p">))</span>
</pre></div>
</div>
<p>To specify additional constraints to the model, we create several
descriptors for the activity, local dopant concentration, and the global
dopant concentration.</p>
<p>Notice that in each case, we specify a subset of locations or atoms of
interest. This is because, for example, our material activity depends on
oxygen sites only and it would be nonsensical to try to interpret one of
the conformations on a different type of site. Similarly, the dopant
budgets are written only over In atoms and not on Ba, Fe, or O.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">addGlobalDescriptor</span><span class="p">(</span><span class="s1">&#39;Activity&#39;</span><span class="p">,</span>
                      <span class="n">rules</span><span class="o">=</span><span class="n">EqualTo</span><span class="p">(</span><span class="n">SumSitesAndConfs</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Zic</span><span class="p">,</span><span class="n">coefs</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">OSites</span><span class="p">),</span><span class="n">sites_to_sum</span><span class="o">=</span><span class="n">OSites</span><span class="p">)))</span>
<span class="n">m</span><span class="o">.</span><span class="n">addGlobalTypesDescriptor</span><span class="p">(</span><span class="s1">&#39;GlobalIndiumConc&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">GlobalLB</span><span class="p">,</span><span class="n">GlobalUB</span><span class="p">),</span>
                           <span class="n">rules</span><span class="o">=</span><span class="n">EqualTo</span><span class="p">(</span><span class="n">SumSites</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Yik</span><span class="p">,</span>
                                                  <span class="n">site_types</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">)],</span>
                                                  <span class="n">sites_to_sum</span><span class="o">=</span><span class="n">BSites</span><span class="p">)))</span>
<span class="n">m</span><span class="o">.</span><span class="n">addSitesTypesDescriptor</span><span class="p">(</span><span class="s1">&#39;LocalIndiumConc&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">LocalBounds</span><span class="p">,</span>
                          <span class="n">rules</span><span class="o">=</span><span class="n">EqualTo</span><span class="p">(</span><span class="n">SumNeighborSites</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Yik</span><span class="p">,</span>
                                                         <span class="n">sites</span><span class="o">=</span><span class="n">OSites</span><span class="p">,</span>
                                                         <span class="n">site_types</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;In&#39;</span><span class="p">)])))</span>
</pre></div>
</div>
</div>
<div class="section" id="solving-the-model">
<h2>Solving the Model<a class="headerlink" href="#solving-the-model" title="Permalink to this headline">¶</a></h2>
<p>Given a fully formed model, we can optimize by maximizing or minimizing
one of the global descriptors.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">maximize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Activity</span><span class="p">,</span><span class="n">tilim</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MaOpt can not find usable solver (CPLEX or NEOS-CPLEX)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>WARNING: DEPRECATED: SetProduct.set_tuple is deprecated.  Use
    SetProduct.subsets() to get the operator arguments.  (deprecated in 5.7)
    (called from /home/ksb/anaconda3/envs/examples-rel/lib/python3.7/site-
    packages/idaes/apps/matopt/../matopt/opt/pyomo_modeling.py:284)

Welcome to IBM(R) ILOG(R) CPLEX(R) Interactive Optimizer Community Edition 12.9.0.0
  with Simplex, Mixed Integer &amp; Barrier Optimizers
5725-A06 5725-A29 5724-Y48 5724-Y49 5724-Y54 5724-Y55 5655-Y21
Copyright IBM Corp. 1988, 2019.  All Rights Reserved.

Type &#39;help&#39; for a list of available commands.
Type &#39;help&#39; followed by a command name for more
information on commands.

CPLEX&gt; Logfile &#39;cplex.log&#39; closed.
Logfile &#39;/tmp/tmpc6bi7v0s.cplex.log&#39; open.
CPLEX&gt; New value for absolute mixed integer optimality gap tolerance: 0
CPLEX&gt; New value for mixed integer optimality gap tolerance: 0
CPLEX&gt; New value for time limit in seconds: 360
CPLEX&gt; Problem &#39;/tmp/tmpmzs3o4qb.pyomo.lp&#39; read.
Read time = 0.01 sec. (0.31 ticks)
CPLEX&gt; Problem name         : /tmp/tmpmzs3o4qb.pyomo.lp
Objective sense      : Maximize
Variables            :     843  [Nneg: 1,  Box: 25,  Free: 1,  Binary: 816]
Objective nonzeros   :       1
Linear constraints   :    1459  [Less: 1424,  Equal: 35]
  Nonzeros           :   17523
  RHS nonzeros       :    1113

Variables            : Min LB: 0.000000         Max UB: 10.00000
Objective nonzeros   : Min   : 1.000000         Max   : 1.000000
Linear constraints   :
  Nonzeros           : Min   : 0.04166667       Max   : 2.000000
  RHS nonzeros       : Min   : 1.000000         Max   : 9.000000
CPLEX&gt; CPLEX Error  1016: Community Edition. Problem size limits exceeded. Purchase at https://ibm.co/2s0wqSa.

Error termination, CPLEX Error  1016.
Solution time =    0.00 sec.
Deterministic time = 0.00 ticks  (0.00 ticks/sec)

CPLEX&gt; CPLEX Error  1217: No solution exists.
No file written.
CPLEX&gt; ERROR: evaluating object as numeric value: obj
        (object: &lt;class &#39;pyomo.core.base.objective.SimpleObjective&#39;&gt;)
    No value for uninitialized NumericValue object obj
MaOpt can not find usable solver (CPLEX or NEOS-CPLEX)
</pre></div>
</div>
</div>
<div class="section" id="processing-solutions">
<h2>Processing Solutions<a class="headerlink" href="#processing-solutions" title="Permalink to this headline">¶</a></h2>
<p>If the optimizer was successful in finding an optimal (or just feasible)
solution, we can plot the resulting design to any of several standard
file formats. However, it is often useful to modify the design to
highlight key features. Here, we label all O-sites that constitute one
of the desired conformations by replacing the atom with an S.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">D</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">Zic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Zic</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">):</span>
            <span class="n">D</span><span class="o">.</span><span class="n">setContent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">))</span>
    <span class="n">D</span><span class="o">.</span><span class="n">toCFG</span><span class="p">(</span><span class="s1">&#39;result.cfg&#39;</span><span class="p">,</span><span class="n">BBox</span><span class="o">=</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright DOE Institute for the Design of Advanced Energy Systems (IDAES), 2018-2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div id="bottombanner">
    The IDAES team:
    <ul>
        <li>National Energy Technology Laboratory (Lead)</li>
        <li>Sandia National Laboratory</li>
        <li>Lawrence Berkeley National Laboratory</li>
        <li>Carnegie-Mellon University (subcontract to LBNL)</li>
        <li>West Virginia University (subcontract to LBNL)</li>
    </ul>
    <div id="contactinfo">
        General, background and overview information<br/> is available at the
        <a href="https://www.idaes.org>">IDAES main website</a>
    </div>
</div>


</body>
</html>